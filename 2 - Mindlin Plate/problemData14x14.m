% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=14;ney=14;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.357143,0.,0;0.714286,0.,0;1.07143,0.,0;1.42857,0.,0;1.78571,0.,0;2.14286,0.,0;2.5,0.,0;2.85714,0.,0;3.21429,0.,0;3.57143,0.,0;3.92857,0.,0;4.28571,0.,0;4.64286,0.,0;5.,0.,0;5.35714,0.,0;5.71429,0.,0;6.07143,0.,0;6.42857,0.,0;6.78571,0.,0;7.14286,0.,0;7.5,0.,0;7.85714,0.,0;8.21429,0.,0;8.57143,0.,0;8.92857,0.,0;9.28571,0.,0;9.64286,0.,0;10.,0.,0;0.,0.714286,0;0.357143,0.714286,0;0.714286,0.714286,0;1.07143,0.714286,0;1.42857,0.714286,0;1.78571,0.714286,0;2.14286,0.714286,0;2.5,0.714286,0;2.85714,0.714286,0;3.21429,0.714286,0;3.57143,0.714286,0;3.92857,0.714286,0;4.28571,0.714286,0;4.64286,0.714286,0;5.,0.714286,0;5.35714,0.714286,0;5.71429,0.714286,0;6.07143,0.714286,0;6.42857,0.714286,0;6.78571,0.714286,0;7.14286,0.714286,0;7.5,0.714286,0;7.85714,0.714286,0;8.21429,0.714286,0;8.57143,0.714286,0;8.92857,0.714286,0;9.28571,0.714286,0;9.64286,0.714286,0;10.,0.714286,0;0.,1.42857,0;0.357143,1.42857,0;0.714286,1.42857,0;1.07143,1.42857,0;1.42857,1.42857,0;1.78571,1.42857,0;2.14286,1.42857,0;2.5,1.42857,0;2.85714,1.42857,0;3.21429,1.42857,0;3.57143,1.42857,0;3.92857,1.42857,0;4.28571,1.42857,0;4.64286,1.42857,0;5.,1.42857,0;5.35714,1.42857,0;5.71429,1.42857,0;6.07143,1.42857,0;6.42857,1.42857,0;6.78571,1.42857,0;7.14286,1.42857,0;7.5,1.42857,0;7.85714,1.42857,0;8.21429,1.42857,0;8.57143,1.42857,0;8.92857,1.42857,0;9.28571,1.42857,0;9.64286,1.42857,0;10.,1.42857,0;0.,2.14286,0;0.357143,2.14286,0;0.714286,2.14286,0;1.07143,2.14286,0;1.42857,2.14286,0;1.78571,2.14286,0;2.14286,2.14286,0;2.5,2.14286,0;2.85714,2.14286,0;3.21429,2.14286,0;3.57143,2.14286,0;3.92857,2.14286,0;4.28571,2.14286,0;4.64286,2.14286,0;5.,2.14286,0;5.35714,2.14286,0;5.71429,2.14286,0;6.07143,2.14286,0;6.42857,2.14286,0;6.78571,2.14286,0;7.14286,2.14286,0;7.5,2.14286,0;7.85714,2.14286,0;8.21429,2.14286,0;8.57143,2.14286,0;8.92857,2.14286,0;9.28571,2.14286,0;9.64286,2.14286,0;10.,2.14286,0;0.,2.85714,0;0.357143,2.85714,0;0.714286,2.85714,0;1.07143,2.85714,0;1.42857,2.85714,0;1.78571,2.85714,0;2.14286,2.85714,0;2.5,2.85714,0;2.85714,2.85714,0;3.21429,2.85714,0;3.57143,2.85714,0;3.92857,2.85714,0;4.28571,2.85714,0;4.64286,2.85714,0;5.,2.85714,0;5.35714,2.85714,0;5.71429,2.85714,0;6.07143,2.85714,0;6.42857,2.85714,0;6.78571,2.85714,0;7.14286,2.85714,0;7.5,2.85714,0;7.85714,2.85714,0;8.21429,2.85714,0;8.57143,2.85714,0;8.92857,2.85714,0;9.28571,2.85714,0;9.64286,2.85714,0;10.,2.85714,0;0.,3.57143,0;0.357143,3.57143,0;0.714286,3.57143,0;1.07143,3.57143,0;1.42857,3.57143,0;1.78571,3.57143,0;2.14286,3.57143,0;2.5,3.57143,0;2.85714,3.57143,0;3.21429,3.57143,0;3.57143,3.57143,0;3.92857,3.57143,0;4.28571,3.57143,0;4.64286,3.57143,0;5.,3.57143,0;5.35714,3.57143,0;5.71429,3.57143,0;6.07143,3.57143,0;6.42857,3.57143,0;6.78571,3.57143,0;7.14286,3.57143,0;7.5,3.57143,0;7.85714,3.57143,0;8.21429,3.57143,0;8.57143,3.57143,0;8.92857,3.57143,0;9.28571,3.57143,0;9.64286,3.57143,0;10.,3.57143,0;0.,4.28571,0;0.357143,4.28571,0;0.714286,4.28571,0;1.07143,4.28571,0;1.42857,4.28571,0;1.78571,4.28571,0;2.14286,4.28571,0;2.5,4.28571,0;2.85714,4.28571,0;3.21429,4.28571,0;3.57143,4.28571,0;3.92857,4.28571,0;4.28571,4.28571,0;4.64286,4.28571,0;5.,4.28571,0;5.35714,4.28571,0;5.71429,4.28571,0;6.07143,4.28571,0;6.42857,4.28571,0;6.78571,4.28571,0;7.14286,4.28571,0;7.5,4.28571,0;7.85714,4.28571,0;8.21429,4.28571,0;8.57143,4.28571,0;8.92857,4.28571,0;9.28571,4.28571,0;9.64286,4.28571,0;10.,4.28571,0;0.,5.,0;0.357143,5.,0;0.714286,5.,0;1.07143,5.,0;1.42857,5.,0;1.78571,5.,0;2.14286,5.,0;2.5,5.,0;2.85714,5.,0;3.21429,5.,0;3.57143,5.,0;3.92857,5.,0;4.28571,5.,0;4.64286,5.,0;5.,5.,0;5.35714,5.,0;5.71429,5.,0;6.07143,5.,0;6.42857,5.,0;6.78571,5.,0;7.14286,5.,0;7.5,5.,0;7.85714,5.,0;8.21429,5.,0;8.57143,5.,0;8.92857,5.,0;9.28571,5.,0;9.64286,5.,0;10.,5.,0;0.,5.71429,0;0.357143,5.71429,0;0.714286,5.71429,0;1.07143,5.71429,0;1.42857,5.71429,0;1.78571,5.71429,0;2.14286,5.71429,0;2.5,5.71429,0;2.85714,5.71429,0;3.21429,5.71429,0;3.57143,5.71429,0;3.92857,5.71429,0;4.28571,5.71429,0;4.64286,5.71429,0;5.,5.71429,0;5.35714,5.71429,0;5.71429,5.71429,0;6.07143,5.71429,0;6.42857,5.71429,0;6.78571,5.71429,0;7.14286,5.71429,0;7.5,5.71429,0;7.85714,5.71429,0;8.21429,5.71429,0;8.57143,5.71429,0;8.92857,5.71429,0;9.28571,5.71429,0;9.64286,5.71429,0;10.,5.71429,0;0.,6.42857,0;0.357143,6.42857,0;0.714286,6.42857,0;1.07143,6.42857,0;1.42857,6.42857,0;1.78571,6.42857,0;2.14286,6.42857,0;2.5,6.42857,0;2.85714,6.42857,0;3.21429,6.42857,0;3.57143,6.42857,0;3.92857,6.42857,0;4.28571,6.42857,0;4.64286,6.42857,0;5.,6.42857,0;5.35714,6.42857,0;5.71429,6.42857,0;6.07143,6.42857,0;6.42857,6.42857,0;6.78571,6.42857,0;7.14286,6.42857,0;7.5,6.42857,0;7.85714,6.42857,0;8.21429,6.42857,0;8.57143,6.42857,0;8.92857,6.42857,0;9.28571,6.42857,0;9.64286,6.42857,0;10.,6.42857,0;0.,7.14286,0;0.357143,7.14286,0;0.714286,7.14286,0;1.07143,7.14286,0;1.42857,7.14286,0;1.78571,7.14286,0;2.14286,7.14286,0;2.5,7.14286,0;2.85714,7.14286,0;3.21429,7.14286,0;3.57143,7.14286,0;3.92857,7.14286,0;4.28571,7.14286,0;4.64286,7.14286,0;5.,7.14286,0;5.35714,7.14286,0;5.71429,7.14286,0;6.07143,7.14286,0;6.42857,7.14286,0;6.78571,7.14286,0;7.14286,7.14286,0;7.5,7.14286,0;7.85714,7.14286,0;8.21429,7.14286,0;8.57143,7.14286,0;8.92857,7.14286,0;9.28571,7.14286,0;9.64286,7.14286,0;10.,7.14286,0;0.,7.85714,0;0.357143,7.85714,0;0.714286,7.85714,0;1.07143,7.85714,0;1.42857,7.85714,0;1.78571,7.85714,0;2.14286,7.85714,0;2.5,7.85714,0;2.85714,7.85714,0;3.21429,7.85714,0;3.57143,7.85714,0;3.92857,7.85714,0;4.28571,7.85714,0;4.64286,7.85714,0;5.,7.85714,0;5.35714,7.85714,0;5.71429,7.85714,0;6.07143,7.85714,0;6.42857,7.85714,0;6.78571,7.85714,0;7.14286,7.85714,0;7.5,7.85714,0;7.85714,7.85714,0;8.21429,7.85714,0;8.57143,7.85714,0;8.92857,7.85714,0;9.28571,7.85714,0;9.64286,7.85714,0;10.,7.85714,0;0.,8.57143,0;0.357143,8.57143,0;0.714286,8.57143,0;1.07143,8.57143,0;1.42857,8.57143,0;1.78571,8.57143,0;2.14286,8.57143,0;2.5,8.57143,0;2.85714,8.57143,0;3.21429,8.57143,0;3.57143,8.57143,0;3.92857,8.57143,0;4.28571,8.57143,0;4.64286,8.57143,0;5.,8.57143,0;5.35714,8.57143,0;5.71429,8.57143,0;6.07143,8.57143,0;6.42857,8.57143,0;6.78571,8.57143,0;7.14286,8.57143,0;7.5,8.57143,0;7.85714,8.57143,0;8.21429,8.57143,0;8.57143,8.57143,0;8.92857,8.57143,0;9.28571,8.57143,0;9.64286,8.57143,0;10.,8.57143,0;0.,9.28571,0;0.357143,9.28571,0;0.714286,9.28571,0;1.07143,9.28571,0;1.42857,9.28571,0;1.78571,9.28571,0;2.14286,9.28571,0;2.5,9.28571,0;2.85714,9.28571,0;3.21429,9.28571,0;3.57143,9.28571,0;3.92857,9.28571,0;4.28571,9.28571,0;4.64286,9.28571,0;5.,9.28571,0;5.35714,9.28571,0;5.71429,9.28571,0;6.07143,9.28571,0;6.42857,9.28571,0;6.78571,9.28571,0;7.14286,9.28571,0;7.5,9.28571,0;7.85714,9.28571,0;8.21429,9.28571,0;8.57143,9.28571,0;8.92857,9.28571,0;9.28571,9.28571,0;9.64286,9.28571,0;10.,9.28571,0;0.,10.,0;0.357143,10.,0;0.714286,10.,0;1.07143,10.,0;1.42857,10.,0;1.78571,10.,0;2.14286,10.,0;2.5,10.,0;2.85714,10.,0;3.21429,10.,0;3.57143,10.,0;3.92857,10.,0;4.28571,10.,0;4.64286,10.,0;5.,10.,0;5.35714,10.,0;5.71429,10.,0;6.07143,10.,0;6.42857,10.,0;6.78571,10.,0;7.14286,10.,0;7.5,10.,0;7.85714,10.,0;8.21429,10.,0;8.57143,10.,0;8.92857,10.,0;9.28571,10.,0;9.64286,10.,0;10.,10.,0;0.,0.357143,0;0.714286,0.357143,0;1.42857,0.357143,0;2.14286,0.357143,0;2.85714,0.357143,0;3.57143,0.357143,0;4.28571,0.357143,0;5.,0.357143,0;5.71429,0.357143,0;6.42857,0.357143,0;7.14286,0.357143,0;7.85714,0.357143,0;8.57143,0.357143,0;9.28571,0.357143,0;10.,0.357143,0;0.,1.07143,0;0.714286,1.07143,0;1.42857,1.07143,0;2.14286,1.07143,0;2.85714,1.07143,0;3.57143,1.07143,0;4.28571,1.07143,0;5.,1.07143,0;5.71429,1.07143,0;6.42857,1.07143,0;7.14286,1.07143,0;7.85714,1.07143,0;8.57143,1.07143,0;9.28571,1.07143,0;10.,1.07143,0;0.,1.78571,0;0.714286,1.78571,0;1.42857,1.78571,0;2.14286,1.78571,0;2.85714,1.78571,0;3.57143,1.78571,0;4.28571,1.78571,0;5.,1.78571,0;5.71429,1.78571,0;6.42857,1.78571,0;7.14286,1.78571,0;7.85714,1.78571,0;8.57143,1.78571,0;9.28571,1.78571,0;10.,1.78571,0;0.,2.5,0;0.714286,2.5,0;1.42857,2.5,0;2.14286,2.5,0;2.85714,2.5,0;3.57143,2.5,0;4.28571,2.5,0;5.,2.5,0;5.71429,2.5,0;6.42857,2.5,0;7.14286,2.5,0;7.85714,2.5,0;8.57143,2.5,0;9.28571,2.5,0;10.,2.5,0;0.,3.21429,0;0.714286,3.21429,0;1.42857,3.21429,0;2.14286,3.21429,0;2.85714,3.21429,0;3.57143,3.21429,0;4.28571,3.21429,0;5.,3.21429,0;5.71429,3.21429,0;6.42857,3.21429,0;7.14286,3.21429,0;7.85714,3.21429,0;8.57143,3.21429,0;9.28571,3.21429,0;10.,3.21429,0;0.,3.92857,0;0.714286,3.92857,0;1.42857,3.92857,0;2.14286,3.92857,0;2.85714,3.92857,0;3.57143,3.92857,0;4.28571,3.92857,0;5.,3.92857,0;5.71429,3.92857,0;6.42857,3.92857,0;7.14286,3.92857,0;7.85714,3.92857,0;8.57143,3.92857,0;9.28571,3.92857,0;10.,3.92857,0;0.,4.64286,0;0.714286,4.64286,0;1.42857,4.64286,0;2.14286,4.64286,0;2.85714,4.64286,0;3.57143,4.64286,0;4.28571,4.64286,0;5.,4.64286,0;5.71429,4.64286,0;6.42857,4.64286,0;7.14286,4.64286,0;7.85714,4.64286,0;8.57143,4.64286,0;9.28571,4.64286,0;10.,4.64286,0;0.,5.35714,0;0.714286,5.35714,0;1.42857,5.35714,0;2.14286,5.35714,0;2.85714,5.35714,0;3.57143,5.35714,0;4.28571,5.35714,0;5.,5.35714,0;5.71429,5.35714,0;6.42857,5.35714,0;7.14286,5.35714,0;7.85714,5.35714,0;8.57143,5.35714,0;9.28571,5.35714,0;10.,5.35714,0;0.,6.07143,0;0.714286,6.07143,0;1.42857,6.07143,0;2.14286,6.07143,0;2.85714,6.07143,0;3.57143,6.07143,0;4.28571,6.07143,0;5.,6.07143,0;5.71429,6.07143,0;6.42857,6.07143,0;7.14286,6.07143,0;7.85714,6.07143,0;8.57143,6.07143,0;9.28571,6.07143,0;10.,6.07143,0;0.,6.78571,0;0.714286,6.78571,0;1.42857,6.78571,0;2.14286,6.78571,0;2.85714,6.78571,0;3.57143,6.78571,0;4.28571,6.78571,0;5.,6.78571,0;5.71429,6.78571,0;6.42857,6.78571,0;7.14286,6.78571,0;7.85714,6.78571,0;8.57143,6.78571,0;9.28571,6.78571,0;10.,6.78571,0;0.,7.5,0;0.714286,7.5,0;1.42857,7.5,0;2.14286,7.5,0;2.85714,7.5,0;3.57143,7.5,0;4.28571,7.5,0;5.,7.5,0;5.71429,7.5,0;6.42857,7.5,0;7.14286,7.5,0;7.85714,7.5,0;8.57143,7.5,0;9.28571,7.5,0;10.,7.5,0;0.,8.21429,0;0.714286,8.21429,0;1.42857,8.21429,0;2.14286,8.21429,0;2.85714,8.21429,0;3.57143,8.21429,0;4.28571,8.21429,0;5.,8.21429,0;5.71429,8.21429,0;6.42857,8.21429,0;7.14286,8.21429,0;7.85714,8.21429,0;8.57143,8.21429,0;9.28571,8.21429,0;10.,8.21429,0;0.,8.92857,0;0.714286,8.92857,0;1.42857,8.92857,0;2.14286,8.92857,0;2.85714,8.92857,0;3.57143,8.92857,0;4.28571,8.92857,0;5.,8.92857,0;5.71429,8.92857,0;6.42857,8.92857,0;7.14286,8.92857,0;7.85714,8.92857,0;8.57143,8.92857,0;9.28571,8.92857,0;10.,8.92857,0;0.,9.64286,0;0.714286,9.64286,0;1.42857,9.64286,0;2.14286,9.64286,0;2.85714,9.64286,0;3.57143,9.64286,0;4.28571,9.64286,0;5.,9.64286,0;5.71429,9.64286,0;6.42857,9.64286,0;7.14286,9.64286,0;7.85714,9.64286,0;8.57143,9.64286,0;9.28571,9.64286,0;10.,9.64286,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,437,32,31,30,436;30,31,32,452,61,60,59,451;59,60,61,467,90,89,88,466;88,89,90,482,119,118,117,481;117,118,119,497,148,147,146,496;146,147,148,512,177,176,175,511;175,176,177,527,206,205,204,526;204,205,206,542,235,234,233,541;233,234,235,557,264,263,262,556;262,263,264,572,293,292,291,571;291,292,293,587,322,321,320,586;320,321,322,602,351,350,349,601;349,350,351,617,380,379,378,616;378,379,380,632,409,408,407,631;3,4,5,438,34,33,32,437;32,33,34,453,63,62,61,452;61,62,63,468,92,91,90,467;90,91,92,483,121,120,119,482;119,120,121,498,150,149,148,497;148,149,150,513,179,178,177,512;177,178,179,528,208,207,206,527;206,207,208,543,237,236,235,542;235,236,237,558,266,265,264,557;264,265,266,573,295,294,293,572;293,294,295,588,324,323,322,587;322,323,324,603,353,352,351,602;351,352,353,618,382,381,380,617;380,381,382,633,411,410,409,632;5,6,7,439,36,35,34,438;34,35,36,454,65,64,63,453;63,64,65,469,94,93,92,468;92,93,94,484,123,122,121,483;121,122,123,499,152,151,150,498;150,151,152,514,181,180,179,513;179,180,181,529,210,209,208,528;208,209,210,544,239,238,237,543;237,238,239,559,268,267,266,558;266,267,268,574,297,296,295,573;295,296,297,589,326,325,324,588;324,325,326,604,355,354,353,603;353,354,355,619,384,383,382,618;382,383,384,634,413,412,411,633;7,8,9,440,38,37,36,439;36,37,38,455,67,66,65,454;65,66,67,470,96,95,94,469;94,95,96,485,125,124,123,484;123,124,125,500,154,153,152,499;152,153,154,515,183,182,181,514;181,182,183,530,212,211,210,529;210,211,212,545,241,240,239,544;239,240,241,560,270,269,268,559;268,269,270,575,299,298,297,574;297,298,299,590,328,327,326,589;326,327,328,605,357,356,355,604;355,356,357,620,386,385,384,619;384,385,386,635,415,414,413,634;9,10,11,441,40,39,38,440;38,39,40,456,69,68,67,455;67,68,69,471,98,97,96,470;96,97,98,486,127,126,125,485;125,126,127,501,156,155,154,500;154,155,156,516,185,184,183,515;183,184,185,531,214,213,212,530;212,213,214,546,243,242,241,545;241,242,243,561,272,271,270,560;270,271,272,576,301,300,299,575;299,300,301,591,330,329,328,590;328,329,330,606,359,358,357,605;357,358,359,621,388,387,386,620;386,387,388,636,417,416,415,635;11,12,13,442,42,41,40,441;40,41,42,457,71,70,69,456;69,70,71,472,100,99,98,471;98,99,100,487,129,128,127,486;127,128,129,502,158,157,156,501;156,157,158,517,187,186,185,516;185,186,187,532,216,215,214,531;214,215,216,547,245,244,243,546;243,244,245,562,274,273,272,561;272,273,274,577,303,302,301,576;301,302,303,592,332,331,330,591;330,331,332,607,361,360,359,606;359,360,361,622,390,389,388,621;388,389,390,637,419,418,417,636;13,14,15,443,44,43,42,442;42,43,44,458,73,72,71,457;71,72,73,473,102,101,100,472;100,101,102,488,131,130,129,487;129,130,131,503,160,159,158,502;158,159,160,518,189,188,187,517;187,188,189,533,218,217,216,532;216,217,218,548,247,246,245,547;245,246,247,563,276,275,274,562;274,275,276,578,305,304,303,577;303,304,305,593,334,333,332,592;332,333,334,608,363,362,361,607;361,362,363,623,392,391,390,622;390,391,392,638,421,420,419,637;15,16,17,444,46,45,44,443;44,45,46,459,75,74,73,458;73,74,75,474,104,103,102,473;102,103,104,489,133,132,131,488;131,132,133,504,162,161,160,503;160,161,162,519,191,190,189,518;189,190,191,534,220,219,218,533;218,219,220,549,249,248,247,548;247,248,249,564,278,277,276,563;276,277,278,579,307,306,305,578;305,306,307,594,336,335,334,593;334,335,336,609,365,364,363,608;363,364,365,624,394,393,392,623;392,393,394,639,423,422,421,638;17,18,19,445,48,47,46,444;46,47,48,460,77,76,75,459;75,76,77,475,106,105,104,474;104,105,106,490,135,134,133,489;133,134,135,505,164,163,162,504;162,163,164,520,193,192,191,519;191,192,193,535,222,221,220,534;220,221,222,550,251,250,249,549;249,250,251,565,280,279,278,564;278,279,280,580,309,308,307,579;307,308,309,595,338,337,336,594;336,337,338,610,367,366,365,609;365,366,367,625,396,395,394,624;394,395,396,640,425,424,423,639;19,20,21,446,50,49,48,445;48,49,50,461,79,78,77,460;77,78,79,476,108,107,106,475;106,107,108,491,137,136,135,490;135,136,137,506,166,165,164,505;164,165,166,521,195,194,193,520;193,194,195,536,224,223,222,535;222,223,224,551,253,252,251,550;251,252,253,566,282,281,280,565;280,281,282,581,311,310,309,580;309,310,311,596,340,339,338,595;338,339,340,611,369,368,367,610;367,368,369,626,398,397,396,625;396,397,398,641,427,426,425,640;21,22,23,447,52,51,50,446;50,51,52,462,81,80,79,461;79,80,81,477,110,109,108,476;108,109,110,492,139,138,137,491;137,138,139,507,168,167,166,506;166,167,168,522,197,196,195,521;195,196,197,537,226,225,224,536;224,225,226,552,255,254,253,551;253,254,255,567,284,283,282,566;282,283,284,582,313,312,311,581;311,312,313,597,342,341,340,596;340,341,342,612,371,370,369,611;369,370,371,627,400,399,398,626;398,399,400,642,429,428,427,641;23,24,25,448,54,53,52,447;52,53,54,463,83,82,81,462;81,82,83,478,112,111,110,477;110,111,112,493,141,140,139,492;139,140,141,508,170,169,168,507;168,169,170,523,199,198,197,522;197,198,199,538,228,227,226,537;226,227,228,553,257,256,255,552;255,256,257,568,286,285,284,567;284,285,286,583,315,314,313,582;313,314,315,598,344,343,342,597;342,343,344,613,373,372,371,612;371,372,373,628,402,401,400,627;400,401,402,643,431,430,429,642;25,26,27,449,56,55,54,448;54,55,56,464,85,84,83,463;83,84,85,479,114,113,112,478;112,113,114,494,143,142,141,493;141,142,143,509,172,171,170,508;170,171,172,524,201,200,199,523;199,200,201,539,230,229,228,538;228,229,230,554,259,258,257,553;257,258,259,569,288,287,286,568;286,287,288,584,317,316,315,583;315,316,317,599,346,345,344,598;344,345,346,614,375,374,373,613;373,374,375,629,404,403,402,628;402,403,404,644,433,432,431,643;27,28,29,450,58,57,56,449;56,57,58,465,87,86,85,464;85,86,87,480,116,115,114,479;114,115,116,495,145,144,143,494;143,144,145,510,174,173,172,509;172,173,174,525,203,202,201,524;201,202,203,540,232,231,230,539;230,231,232,555,261,260,259,554;259,260,261,570,290,289,288,569;288,289,290,585,319,318,317,584;317,318,319,600,348,347,346,599;346,347,348,615,377,376,375,614;375,376,377,630,406,405,404,629;404,405,406,645,435,434,433,644];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];