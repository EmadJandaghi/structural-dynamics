% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=16;ney=16;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.3125,0.,0;0.625,0.,0;0.9375,0.,0;1.25,0.,0;1.5625,0.,0;1.875,0.,0;2.1875,0.,0;2.5,0.,0;2.8125,0.,0;3.125,0.,0;3.4375,0.,0;3.75,0.,0;4.0625,0.,0;4.375,0.,0;4.6875,0.,0;5.,0.,0;5.3125,0.,0;5.625,0.,0;5.9375,0.,0;6.25,0.,0;6.5625,0.,0;6.875,0.,0;7.1875,0.,0;7.5,0.,0;7.8125,0.,0;8.125,0.,0;8.4375,0.,0;8.75,0.,0;9.0625,0.,0;9.375,0.,0;9.6875,0.,0;10.,0.,0;0.,0.625,0;0.3125,0.625,0;0.625,0.625,0;0.9375,0.625,0;1.25,0.625,0;1.5625,0.625,0;1.875,0.625,0;2.1875,0.625,0;2.5,0.625,0;2.8125,0.625,0;3.125,0.625,0;3.4375,0.625,0;3.75,0.625,0;4.0625,0.625,0;4.375,0.625,0;4.6875,0.625,0;5.,0.625,0;5.3125,0.625,0;5.625,0.625,0;5.9375,0.625,0;6.25,0.625,0;6.5625,0.625,0;6.875,0.625,0;7.1875,0.625,0;7.5,0.625,0;7.8125,0.625,0;8.125,0.625,0;8.4375,0.625,0;8.75,0.625,0;9.0625,0.625,0;9.375,0.625,0;9.6875,0.625,0;10.,0.625,0;0.,1.25,0;0.3125,1.25,0;0.625,1.25,0;0.9375,1.25,0;1.25,1.25,0;1.5625,1.25,0;1.875,1.25,0;2.1875,1.25,0;2.5,1.25,0;2.8125,1.25,0;3.125,1.25,0;3.4375,1.25,0;3.75,1.25,0;4.0625,1.25,0;4.375,1.25,0;4.6875,1.25,0;5.,1.25,0;5.3125,1.25,0;5.625,1.25,0;5.9375,1.25,0;6.25,1.25,0;6.5625,1.25,0;6.875,1.25,0;7.1875,1.25,0;7.5,1.25,0;7.8125,1.25,0;8.125,1.25,0;8.4375,1.25,0;8.75,1.25,0;9.0625,1.25,0;9.375,1.25,0;9.6875,1.25,0;10.,1.25,0;0.,1.875,0;0.3125,1.875,0;0.625,1.875,0;0.9375,1.875,0;1.25,1.875,0;1.5625,1.875,0;1.875,1.875,0;2.1875,1.875,0;2.5,1.875,0;2.8125,1.875,0;3.125,1.875,0;3.4375,1.875,0;3.75,1.875,0;4.0625,1.875,0;4.375,1.875,0;4.6875,1.875,0;5.,1.875,0;5.3125,1.875,0;5.625,1.875,0;5.9375,1.875,0;6.25,1.875,0;6.5625,1.875,0;6.875,1.875,0;7.1875,1.875,0;7.5,1.875,0;7.8125,1.875,0;8.125,1.875,0;8.4375,1.875,0;8.75,1.875,0;9.0625,1.875,0;9.375,1.875,0;9.6875,1.875,0;10.,1.875,0;0.,2.5,0;0.3125,2.5,0;0.625,2.5,0;0.9375,2.5,0;1.25,2.5,0;1.5625,2.5,0;1.875,2.5,0;2.1875,2.5,0;2.5,2.5,0;2.8125,2.5,0;3.125,2.5,0;3.4375,2.5,0;3.75,2.5,0;4.0625,2.5,0;4.375,2.5,0;4.6875,2.5,0;5.,2.5,0;5.3125,2.5,0;5.625,2.5,0;5.9375,2.5,0;6.25,2.5,0;6.5625,2.5,0;6.875,2.5,0;7.1875,2.5,0;7.5,2.5,0;7.8125,2.5,0;8.125,2.5,0;8.4375,2.5,0;8.75,2.5,0;9.0625,2.5,0;9.375,2.5,0;9.6875,2.5,0;10.,2.5,0;0.,3.125,0;0.3125,3.125,0;0.625,3.125,0;0.9375,3.125,0;1.25,3.125,0;1.5625,3.125,0;1.875,3.125,0;2.1875,3.125,0;2.5,3.125,0;2.8125,3.125,0;3.125,3.125,0;3.4375,3.125,0;3.75,3.125,0;4.0625,3.125,0;4.375,3.125,0;4.6875,3.125,0;5.,3.125,0;5.3125,3.125,0;5.625,3.125,0;5.9375,3.125,0;6.25,3.125,0;6.5625,3.125,0;6.875,3.125,0;7.1875,3.125,0;7.5,3.125,0;7.8125,3.125,0;8.125,3.125,0;8.4375,3.125,0;8.75,3.125,0;9.0625,3.125,0;9.375,3.125,0;9.6875,3.125,0;10.,3.125,0;0.,3.75,0;0.3125,3.75,0;0.625,3.75,0;0.9375,3.75,0;1.25,3.75,0;1.5625,3.75,0;1.875,3.75,0;2.1875,3.75,0;2.5,3.75,0;2.8125,3.75,0;3.125,3.75,0;3.4375,3.75,0;3.75,3.75,0;4.0625,3.75,0;4.375,3.75,0;4.6875,3.75,0;5.,3.75,0;5.3125,3.75,0;5.625,3.75,0;5.9375,3.75,0;6.25,3.75,0;6.5625,3.75,0;6.875,3.75,0;7.1875,3.75,0;7.5,3.75,0;7.8125,3.75,0;8.125,3.75,0;8.4375,3.75,0;8.75,3.75,0;9.0625,3.75,0;9.375,3.75,0;9.6875,3.75,0;10.,3.75,0;0.,4.375,0;0.3125,4.375,0;0.625,4.375,0;0.9375,4.375,0;1.25,4.375,0;1.5625,4.375,0;1.875,4.375,0;2.1875,4.375,0;2.5,4.375,0;2.8125,4.375,0;3.125,4.375,0;3.4375,4.375,0;3.75,4.375,0;4.0625,4.375,0;4.375,4.375,0;4.6875,4.375,0;5.,4.375,0;5.3125,4.375,0;5.625,4.375,0;5.9375,4.375,0;6.25,4.375,0;6.5625,4.375,0;6.875,4.375,0;7.1875,4.375,0;7.5,4.375,0;7.8125,4.375,0;8.125,4.375,0;8.4375,4.375,0;8.75,4.375,0;9.0625,4.375,0;9.375,4.375,0;9.6875,4.375,0;10.,4.375,0;0.,5.,0;0.3125,5.,0;0.625,5.,0;0.9375,5.,0;1.25,5.,0;1.5625,5.,0;1.875,5.,0;2.1875,5.,0;2.5,5.,0;2.8125,5.,0;3.125,5.,0;3.4375,5.,0;3.75,5.,0;4.0625,5.,0;4.375,5.,0;4.6875,5.,0;5.,5.,0;5.3125,5.,0;5.625,5.,0;5.9375,5.,0;6.25,5.,0;6.5625,5.,0;6.875,5.,0;7.1875,5.,0;7.5,5.,0;7.8125,5.,0;8.125,5.,0;8.4375,5.,0;8.75,5.,0;9.0625,5.,0;9.375,5.,0;9.6875,5.,0;10.,5.,0;0.,5.625,0;0.3125,5.625,0;0.625,5.625,0;0.9375,5.625,0;1.25,5.625,0;1.5625,5.625,0;1.875,5.625,0;2.1875,5.625,0;2.5,5.625,0;2.8125,5.625,0;3.125,5.625,0;3.4375,5.625,0;3.75,5.625,0;4.0625,5.625,0;4.375,5.625,0;4.6875,5.625,0;5.,5.625,0;5.3125,5.625,0;5.625,5.625,0;5.9375,5.625,0;6.25,5.625,0;6.5625,5.625,0;6.875,5.625,0;7.1875,5.625,0;7.5,5.625,0;7.8125,5.625,0;8.125,5.625,0;8.4375,5.625,0;8.75,5.625,0;9.0625,5.625,0;9.375,5.625,0;9.6875,5.625,0;10.,5.625,0;0.,6.25,0;0.3125,6.25,0;0.625,6.25,0;0.9375,6.25,0;1.25,6.25,0;1.5625,6.25,0;1.875,6.25,0;2.1875,6.25,0;2.5,6.25,0;2.8125,6.25,0;3.125,6.25,0;3.4375,6.25,0;3.75,6.25,0;4.0625,6.25,0;4.375,6.25,0;4.6875,6.25,0;5.,6.25,0;5.3125,6.25,0;5.625,6.25,0;5.9375,6.25,0;6.25,6.25,0;6.5625,6.25,0;6.875,6.25,0;7.1875,6.25,0;7.5,6.25,0;7.8125,6.25,0;8.125,6.25,0;8.4375,6.25,0;8.75,6.25,0;9.0625,6.25,0;9.375,6.25,0;9.6875,6.25,0;10.,6.25,0;0.,6.875,0;0.3125,6.875,0;0.625,6.875,0;0.9375,6.875,0;1.25,6.875,0;1.5625,6.875,0;1.875,6.875,0;2.1875,6.875,0;2.5,6.875,0;2.8125,6.875,0;3.125,6.875,0;3.4375,6.875,0;3.75,6.875,0;4.0625,6.875,0;4.375,6.875,0;4.6875,6.875,0;5.,6.875,0;5.3125,6.875,0;5.625,6.875,0;5.9375,6.875,0;6.25,6.875,0;6.5625,6.875,0;6.875,6.875,0;7.1875,6.875,0;7.5,6.875,0;7.8125,6.875,0;8.125,6.875,0;8.4375,6.875,0;8.75,6.875,0;9.0625,6.875,0;9.375,6.875,0;9.6875,6.875,0;10.,6.875,0;0.,7.5,0;0.3125,7.5,0;0.625,7.5,0;0.9375,7.5,0;1.25,7.5,0;1.5625,7.5,0;1.875,7.5,0;2.1875,7.5,0;2.5,7.5,0;2.8125,7.5,0;3.125,7.5,0;3.4375,7.5,0;3.75,7.5,0;4.0625,7.5,0;4.375,7.5,0;4.6875,7.5,0;5.,7.5,0;5.3125,7.5,0;5.625,7.5,0;5.9375,7.5,0;6.25,7.5,0;6.5625,7.5,0;6.875,7.5,0;7.1875,7.5,0;7.5,7.5,0;7.8125,7.5,0;8.125,7.5,0;8.4375,7.5,0;8.75,7.5,0;9.0625,7.5,0;9.375,7.5,0;9.6875,7.5,0;10.,7.5,0;0.,8.125,0;0.3125,8.125,0;0.625,8.125,0;0.9375,8.125,0;1.25,8.125,0;1.5625,8.125,0;1.875,8.125,0;2.1875,8.125,0;2.5,8.125,0;2.8125,8.125,0;3.125,8.125,0;3.4375,8.125,0;3.75,8.125,0;4.0625,8.125,0;4.375,8.125,0;4.6875,8.125,0;5.,8.125,0;5.3125,8.125,0;5.625,8.125,0;5.9375,8.125,0;6.25,8.125,0;6.5625,8.125,0;6.875,8.125,0;7.1875,8.125,0;7.5,8.125,0;7.8125,8.125,0;8.125,8.125,0;8.4375,8.125,0;8.75,8.125,0;9.0625,8.125,0;9.375,8.125,0;9.6875,8.125,0;10.,8.125,0;0.,8.75,0;0.3125,8.75,0;0.625,8.75,0;0.9375,8.75,0;1.25,8.75,0;1.5625,8.75,0;1.875,8.75,0;2.1875,8.75,0;2.5,8.75,0;2.8125,8.75,0;3.125,8.75,0;3.4375,8.75,0;3.75,8.75,0;4.0625,8.75,0;4.375,8.75,0;4.6875,8.75,0;5.,8.75,0;5.3125,8.75,0;5.625,8.75,0;5.9375,8.75,0;6.25,8.75,0;6.5625,8.75,0;6.875,8.75,0;7.1875,8.75,0;7.5,8.75,0;7.8125,8.75,0;8.125,8.75,0;8.4375,8.75,0;8.75,8.75,0;9.0625,8.75,0;9.375,8.75,0;9.6875,8.75,0;10.,8.75,0;0.,9.375,0;0.3125,9.375,0;0.625,9.375,0;0.9375,9.375,0;1.25,9.375,0;1.5625,9.375,0;1.875,9.375,0;2.1875,9.375,0;2.5,9.375,0;2.8125,9.375,0;3.125,9.375,0;3.4375,9.375,0;3.75,9.375,0;4.0625,9.375,0;4.375,9.375,0;4.6875,9.375,0;5.,9.375,0;5.3125,9.375,0;5.625,9.375,0;5.9375,9.375,0;6.25,9.375,0;6.5625,9.375,0;6.875,9.375,0;7.1875,9.375,0;7.5,9.375,0;7.8125,9.375,0;8.125,9.375,0;8.4375,9.375,0;8.75,9.375,0;9.0625,9.375,0;9.375,9.375,0;9.6875,9.375,0;10.,9.375,0;0.,10.,0;0.3125,10.,0;0.625,10.,0;0.9375,10.,0;1.25,10.,0;1.5625,10.,0;1.875,10.,0;2.1875,10.,0;2.5,10.,0;2.8125,10.,0;3.125,10.,0;3.4375,10.,0;3.75,10.,0;4.0625,10.,0;4.375,10.,0;4.6875,10.,0;5.,10.,0;5.3125,10.,0;5.625,10.,0;5.9375,10.,0;6.25,10.,0;6.5625,10.,0;6.875,10.,0;7.1875,10.,0;7.5,10.,0;7.8125,10.,0;8.125,10.,0;8.4375,10.,0;8.75,10.,0;9.0625,10.,0;9.375,10.,0;9.6875,10.,0;10.,10.,0;0.,0.3125,0;0.625,0.3125,0;1.25,0.3125,0;1.875,0.3125,0;2.5,0.3125,0;3.125,0.3125,0;3.75,0.3125,0;4.375,0.3125,0;5.,0.3125,0;5.625,0.3125,0;6.25,0.3125,0;6.875,0.3125,0;7.5,0.3125,0;8.125,0.3125,0;8.75,0.3125,0;9.375,0.3125,0;10.,0.3125,0;0.,0.9375,0;0.625,0.9375,0;1.25,0.9375,0;1.875,0.9375,0;2.5,0.9375,0;3.125,0.9375,0;3.75,0.9375,0;4.375,0.9375,0;5.,0.9375,0;5.625,0.9375,0;6.25,0.9375,0;6.875,0.9375,0;7.5,0.9375,0;8.125,0.9375,0;8.75,0.9375,0;9.375,0.9375,0;10.,0.9375,0;0.,1.5625,0;0.625,1.5625,0;1.25,1.5625,0;1.875,1.5625,0;2.5,1.5625,0;3.125,1.5625,0;3.75,1.5625,0;4.375,1.5625,0;5.,1.5625,0;5.625,1.5625,0;6.25,1.5625,0;6.875,1.5625,0;7.5,1.5625,0;8.125,1.5625,0;8.75,1.5625,0;9.375,1.5625,0;10.,1.5625,0;0.,2.1875,0;0.625,2.1875,0;1.25,2.1875,0;1.875,2.1875,0;2.5,2.1875,0;3.125,2.1875,0;3.75,2.1875,0;4.375,2.1875,0;5.,2.1875,0;5.625,2.1875,0;6.25,2.1875,0;6.875,2.1875,0;7.5,2.1875,0;8.125,2.1875,0;8.75,2.1875,0;9.375,2.1875,0;10.,2.1875,0;0.,2.8125,0;0.625,2.8125,0;1.25,2.8125,0;1.875,2.8125,0;2.5,2.8125,0;3.125,2.8125,0;3.75,2.8125,0;4.375,2.8125,0;5.,2.8125,0;5.625,2.8125,0;6.25,2.8125,0;6.875,2.8125,0;7.5,2.8125,0;8.125,2.8125,0;8.75,2.8125,0;9.375,2.8125,0;10.,2.8125,0;0.,3.4375,0;0.625,3.4375,0;1.25,3.4375,0;1.875,3.4375,0;2.5,3.4375,0;3.125,3.4375,0;3.75,3.4375,0;4.375,3.4375,0;5.,3.4375,0;5.625,3.4375,0;6.25,3.4375,0;6.875,3.4375,0;7.5,3.4375,0;8.125,3.4375,0;8.75,3.4375,0;9.375,3.4375,0;10.,3.4375,0;0.,4.0625,0;0.625,4.0625,0;1.25,4.0625,0;1.875,4.0625,0;2.5,4.0625,0;3.125,4.0625,0;3.75,4.0625,0;4.375,4.0625,0;5.,4.0625,0;5.625,4.0625,0;6.25,4.0625,0;6.875,4.0625,0;7.5,4.0625,0;8.125,4.0625,0;8.75,4.0625,0;9.375,4.0625,0;10.,4.0625,0;0.,4.6875,0;0.625,4.6875,0;1.25,4.6875,0;1.875,4.6875,0;2.5,4.6875,0;3.125,4.6875,0;3.75,4.6875,0;4.375,4.6875,0;5.,4.6875,0;5.625,4.6875,0;6.25,4.6875,0;6.875,4.6875,0;7.5,4.6875,0;8.125,4.6875,0;8.75,4.6875,0;9.375,4.6875,0;10.,4.6875,0;0.,5.3125,0;0.625,5.3125,0;1.25,5.3125,0;1.875,5.3125,0;2.5,5.3125,0;3.125,5.3125,0;3.75,5.3125,0;4.375,5.3125,0;5.,5.3125,0;5.625,5.3125,0;6.25,5.3125,0;6.875,5.3125,0;7.5,5.3125,0;8.125,5.3125,0;8.75,5.3125,0;9.375,5.3125,0;10.,5.3125,0;0.,5.9375,0;0.625,5.9375,0;1.25,5.9375,0;1.875,5.9375,0;2.5,5.9375,0;3.125,5.9375,0;3.75,5.9375,0;4.375,5.9375,0;5.,5.9375,0;5.625,5.9375,0;6.25,5.9375,0;6.875,5.9375,0;7.5,5.9375,0;8.125,5.9375,0;8.75,5.9375,0;9.375,5.9375,0;10.,5.9375,0;0.,6.5625,0;0.625,6.5625,0;1.25,6.5625,0;1.875,6.5625,0;2.5,6.5625,0;3.125,6.5625,0;3.75,6.5625,0;4.375,6.5625,0;5.,6.5625,0;5.625,6.5625,0;6.25,6.5625,0;6.875,6.5625,0;7.5,6.5625,0;8.125,6.5625,0;8.75,6.5625,0;9.375,6.5625,0;10.,6.5625,0;0.,7.1875,0;0.625,7.1875,0;1.25,7.1875,0;1.875,7.1875,0;2.5,7.1875,0;3.125,7.1875,0;3.75,7.1875,0;4.375,7.1875,0;5.,7.1875,0;5.625,7.1875,0;6.25,7.1875,0;6.875,7.1875,0;7.5,7.1875,0;8.125,7.1875,0;8.75,7.1875,0;9.375,7.1875,0;10.,7.1875,0;0.,7.8125,0;0.625,7.8125,0;1.25,7.8125,0;1.875,7.8125,0;2.5,7.8125,0;3.125,7.8125,0;3.75,7.8125,0;4.375,7.8125,0;5.,7.8125,0;5.625,7.8125,0;6.25,7.8125,0;6.875,7.8125,0;7.5,7.8125,0;8.125,7.8125,0;8.75,7.8125,0;9.375,7.8125,0;10.,7.8125,0;0.,8.4375,0;0.625,8.4375,0;1.25,8.4375,0;1.875,8.4375,0;2.5,8.4375,0;3.125,8.4375,0;3.75,8.4375,0;4.375,8.4375,0;5.,8.4375,0;5.625,8.4375,0;6.25,8.4375,0;6.875,8.4375,0;7.5,8.4375,0;8.125,8.4375,0;8.75,8.4375,0;9.375,8.4375,0;10.,8.4375,0;0.,9.0625,0;0.625,9.0625,0;1.25,9.0625,0;1.875,9.0625,0;2.5,9.0625,0;3.125,9.0625,0;3.75,9.0625,0;4.375,9.0625,0;5.,9.0625,0;5.625,9.0625,0;6.25,9.0625,0;6.875,9.0625,0;7.5,9.0625,0;8.125,9.0625,0;8.75,9.0625,0;9.375,9.0625,0;10.,9.0625,0;0.,9.6875,0;0.625,9.6875,0;1.25,9.6875,0;1.875,9.6875,0;2.5,9.6875,0;3.125,9.6875,0;3.75,9.6875,0;4.375,9.6875,0;5.,9.6875,0;5.625,9.6875,0;6.25,9.6875,0;6.875,9.6875,0;7.5,9.6875,0;8.125,9.6875,0;8.75,9.6875,0;9.375,9.6875,0;10.,9.6875,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,563,36,35,34,562;34,35,36,580,69,68,67,579;67,68,69,597,102,101,100,596;100,101,102,614,135,134,133,613;133,134,135,631,168,167,166,630;166,167,168,648,201,200,199,647;199,200,201,665,234,233,232,664;232,233,234,682,267,266,265,681;265,266,267,699,300,299,298,698;298,299,300,716,333,332,331,715;331,332,333,733,366,365,364,732;364,365,366,750,399,398,397,749;397,398,399,767,432,431,430,766;430,431,432,784,465,464,463,783;463,464,465,801,498,497,496,800;496,497,498,818,531,530,529,817;3,4,5,564,38,37,36,563;36,37,38,581,71,70,69,580;69,70,71,598,104,103,102,597;102,103,104,615,137,136,135,614;135,136,137,632,170,169,168,631;168,169,170,649,203,202,201,648;201,202,203,666,236,235,234,665;234,235,236,683,269,268,267,682;267,268,269,700,302,301,300,699;300,301,302,717,335,334,333,716;333,334,335,734,368,367,366,733;366,367,368,751,401,400,399,750;399,400,401,768,434,433,432,767;432,433,434,785,467,466,465,784;465,466,467,802,500,499,498,801;498,499,500,819,533,532,531,818;5,6,7,565,40,39,38,564;38,39,40,582,73,72,71,581;71,72,73,599,106,105,104,598;104,105,106,616,139,138,137,615;137,138,139,633,172,171,170,632;170,171,172,650,205,204,203,649;203,204,205,667,238,237,236,666;236,237,238,684,271,270,269,683;269,270,271,701,304,303,302,700;302,303,304,718,337,336,335,717;335,336,337,735,370,369,368,734;368,369,370,752,403,402,401,751;401,402,403,769,436,435,434,768;434,435,436,786,469,468,467,785;467,468,469,803,502,501,500,802;500,501,502,820,535,534,533,819;7,8,9,566,42,41,40,565;40,41,42,583,75,74,73,582;73,74,75,600,108,107,106,599;106,107,108,617,141,140,139,616;139,140,141,634,174,173,172,633;172,173,174,651,207,206,205,650;205,206,207,668,240,239,238,667;238,239,240,685,273,272,271,684;271,272,273,702,306,305,304,701;304,305,306,719,339,338,337,718;337,338,339,736,372,371,370,735;370,371,372,753,405,404,403,752;403,404,405,770,438,437,436,769;436,437,438,787,471,470,469,786;469,470,471,804,504,503,502,803;502,503,504,821,537,536,535,820;9,10,11,567,44,43,42,566;42,43,44,584,77,76,75,583;75,76,77,601,110,109,108,600;108,109,110,618,143,142,141,617;141,142,143,635,176,175,174,634;174,175,176,652,209,208,207,651;207,208,209,669,242,241,240,668;240,241,242,686,275,274,273,685;273,274,275,703,308,307,306,702;306,307,308,720,341,340,339,719;339,340,341,737,374,373,372,736;372,373,374,754,407,406,405,753;405,406,407,771,440,439,438,770;438,439,440,788,473,472,471,787;471,472,473,805,506,505,504,804;504,505,506,822,539,538,537,821;11,12,13,568,46,45,44,567;44,45,46,585,79,78,77,584;77,78,79,602,112,111,110,601;110,111,112,619,145,144,143,618;143,144,145,636,178,177,176,635;176,177,178,653,211,210,209,652;209,210,211,670,244,243,242,669;242,243,244,687,277,276,275,686;275,276,277,704,310,309,308,703;308,309,310,721,343,342,341,720;341,342,343,738,376,375,374,737;374,375,376,755,409,408,407,754;407,408,409,772,442,441,440,771;440,441,442,789,475,474,473,788;473,474,475,806,508,507,506,805;506,507,508,823,541,540,539,822;13,14,15,569,48,47,46,568;46,47,48,586,81,80,79,585;79,80,81,603,114,113,112,602;112,113,114,620,147,146,145,619;145,146,147,637,180,179,178,636;178,179,180,654,213,212,211,653;211,212,213,671,246,245,244,670;244,245,246,688,279,278,277,687;277,278,279,705,312,311,310,704;310,311,312,722,345,344,343,721;343,344,345,739,378,377,376,738;376,377,378,756,411,410,409,755;409,410,411,773,444,443,442,772;442,443,444,790,477,476,475,789;475,476,477,807,510,509,508,806;508,509,510,824,543,542,541,823;15,16,17,570,50,49,48,569;48,49,50,587,83,82,81,586;81,82,83,604,116,115,114,603;114,115,116,621,149,148,147,620;147,148,149,638,182,181,180,637;180,181,182,655,215,214,213,654;213,214,215,672,248,247,246,671;246,247,248,689,281,280,279,688;279,280,281,706,314,313,312,705;312,313,314,723,347,346,345,722;345,346,347,740,380,379,378,739;378,379,380,757,413,412,411,756;411,412,413,774,446,445,444,773;444,445,446,791,479,478,477,790;477,478,479,808,512,511,510,807;510,511,512,825,545,544,543,824;17,18,19,571,52,51,50,570;50,51,52,588,85,84,83,587;83,84,85,605,118,117,116,604;116,117,118,622,151,150,149,621;149,150,151,639,184,183,182,638;182,183,184,656,217,216,215,655;215,216,217,673,250,249,248,672;248,249,250,690,283,282,281,689;281,282,283,707,316,315,314,706;314,315,316,724,349,348,347,723;347,348,349,741,382,381,380,740;380,381,382,758,415,414,413,757;413,414,415,775,448,447,446,774;446,447,448,792,481,480,479,791;479,480,481,809,514,513,512,808;512,513,514,826,547,546,545,825;19,20,21,572,54,53,52,571;52,53,54,589,87,86,85,588;85,86,87,606,120,119,118,605;118,119,120,623,153,152,151,622;151,152,153,640,186,185,184,639;184,185,186,657,219,218,217,656;217,218,219,674,252,251,250,673;250,251,252,691,285,284,283,690;283,284,285,708,318,317,316,707;316,317,318,725,351,350,349,724;349,350,351,742,384,383,382,741;382,383,384,759,417,416,415,758;415,416,417,776,450,449,448,775;448,449,450,793,483,482,481,792;481,482,483,810,516,515,514,809;514,515,516,827,549,548,547,826;21,22,23,573,56,55,54,572;54,55,56,590,89,88,87,589;87,88,89,607,122,121,120,606;120,121,122,624,155,154,153,623;153,154,155,641,188,187,186,640;186,187,188,658,221,220,219,657;219,220,221,675,254,253,252,674;252,253,254,692,287,286,285,691;285,286,287,709,320,319,318,708;318,319,320,726,353,352,351,725;351,352,353,743,386,385,384,742;384,385,386,760,419,418,417,759;417,418,419,777,452,451,450,776;450,451,452,794,485,484,483,793;483,484,485,811,518,517,516,810;516,517,518,828,551,550,549,827;23,24,25,574,58,57,56,573;56,57,58,591,91,90,89,590;89,90,91,608,124,123,122,607;122,123,124,625,157,156,155,624;155,156,157,642,190,189,188,641;188,189,190,659,223,222,221,658;221,222,223,676,256,255,254,675;254,255,256,693,289,288,287,692;287,288,289,710,322,321,320,709;320,321,322,727,355,354,353,726;353,354,355,744,388,387,386,743;386,387,388,761,421,420,419,760;419,420,421,778,454,453,452,777;452,453,454,795,487,486,485,794;485,486,487,812,520,519,518,811;518,519,520,829,553,552,551,828;25,26,27,575,60,59,58,574;58,59,60,592,93,92,91,591;91,92,93,609,126,125,124,608;124,125,126,626,159,158,157,625;157,158,159,643,192,191,190,642;190,191,192,660,225,224,223,659;223,224,225,677,258,257,256,676;256,257,258,694,291,290,289,693;289,290,291,711,324,323,322,710;322,323,324,728,357,356,355,727;355,356,357,745,390,389,388,744;388,389,390,762,423,422,421,761;421,422,423,779,456,455,454,778;454,455,456,796,489,488,487,795;487,488,489,813,522,521,520,812;520,521,522,830,555,554,553,829;27,28,29,576,62,61,60,575;60,61,62,593,95,94,93,592;93,94,95,610,128,127,126,609;126,127,128,627,161,160,159,626;159,160,161,644,194,193,192,643;192,193,194,661,227,226,225,660;225,226,227,678,260,259,258,677;258,259,260,695,293,292,291,694;291,292,293,712,326,325,324,711;324,325,326,729,359,358,357,728;357,358,359,746,392,391,390,745;390,391,392,763,425,424,423,762;423,424,425,780,458,457,456,779;456,457,458,797,491,490,489,796;489,490,491,814,524,523,522,813;522,523,524,831,557,556,555,830;29,30,31,577,64,63,62,576;62,63,64,594,97,96,95,593;95,96,97,611,130,129,128,610;128,129,130,628,163,162,161,627;161,162,163,645,196,195,194,644;194,195,196,662,229,228,227,661;227,228,229,679,262,261,260,678;260,261,262,696,295,294,293,695;293,294,295,713,328,327,326,712;326,327,328,730,361,360,359,729;359,360,361,747,394,393,392,746;392,393,394,764,427,426,425,763;425,426,427,781,460,459,458,780;458,459,460,798,493,492,491,797;491,492,493,815,526,525,524,814;524,525,526,832,559,558,557,831;31,32,33,578,66,65,64,577;64,65,66,595,99,98,97,594;97,98,99,612,132,131,130,611;130,131,132,629,165,164,163,628;163,164,165,646,198,197,196,645;196,197,198,663,231,230,229,662;229,230,231,680,264,263,262,679;262,263,264,697,297,296,295,696;295,296,297,714,330,329,328,713;328,329,330,731,363,362,361,730;361,362,363,748,396,395,394,747;394,395,396,765,429,428,427,764;427,428,429,782,462,461,460,781;460,461,462,799,495,494,493,798;493,494,495,816,528,527,526,815;526,527,528,833,561,560,559,832];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];