% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=22;ney=22;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.227273,0.,0;0.454545,0.,0;0.681818,0.,0;0.909091,0.,0;1.13636,0.,0;1.36364,0.,0;1.59091,0.,0;1.81818,0.,0;2.04545,0.,0;2.27273,0.,0;2.5,0.,0;2.72727,0.,0;2.95455,0.,0;3.18182,0.,0;3.40909,0.,0;3.63636,0.,0;3.86364,0.,0;4.09091,0.,0;4.31818,0.,0;4.54545,0.,0;4.77273,0.,0;5.,0.,0;5.22727,0.,0;5.45455,0.,0;5.68182,0.,0;5.90909,0.,0;6.13636,0.,0;6.36364,0.,0;6.59091,0.,0;6.81818,0.,0;7.04545,0.,0;7.27273,0.,0;7.5,0.,0;7.72727,0.,0;7.95455,0.,0;8.18182,0.,0;8.40909,0.,0;8.63636,0.,0;8.86364,0.,0;9.09091,0.,0;9.31818,0.,0;9.54545,0.,0;9.77273,0.,0;10.,0.,0;0.,0.454545,0;0.227273,0.454545,0;0.454545,0.454545,0;0.681818,0.454545,0;0.909091,0.454545,0;1.13636,0.454545,0;1.36364,0.454545,0;1.59091,0.454545,0;1.81818,0.454545,0;2.04545,0.454545,0;2.27273,0.454545,0;2.5,0.454545,0;2.72727,0.454545,0;2.95455,0.454545,0;3.18182,0.454545,0;3.40909,0.454545,0;3.63636,0.454545,0;3.86364,0.454545,0;4.09091,0.454545,0;4.31818,0.454545,0;4.54545,0.454545,0;4.77273,0.454545,0;5.,0.454545,0;5.22727,0.454545,0;5.45455,0.454545,0;5.68182,0.454545,0;5.90909,0.454545,0;6.13636,0.454545,0;6.36364,0.454545,0;6.59091,0.454545,0;6.81818,0.454545,0;7.04545,0.454545,0;7.27273,0.454545,0;7.5,0.454545,0;7.72727,0.454545,0;7.95455,0.454545,0;8.18182,0.454545,0;8.40909,0.454545,0;8.63636,0.454545,0;8.86364,0.454545,0;9.09091,0.454545,0;9.31818,0.454545,0;9.54545,0.454545,0;9.77273,0.454545,0;10.,0.454545,0;0.,0.909091,0;0.227273,0.909091,0;0.454545,0.909091,0;0.681818,0.909091,0;0.909091,0.909091,0;1.13636,0.909091,0;1.36364,0.909091,0;1.59091,0.909091,0;1.81818,0.909091,0;2.04545,0.909091,0;2.27273,0.909091,0;2.5,0.909091,0;2.72727,0.909091,0;2.95455,0.909091,0;3.18182,0.909091,0;3.40909,0.909091,0;3.63636,0.909091,0;3.86364,0.909091,0;4.09091,0.909091,0;4.31818,0.909091,0;4.54545,0.909091,0;4.77273,0.909091,0;5.,0.909091,0;5.22727,0.909091,0;5.45455,0.909091,0;5.68182,0.909091,0;5.90909,0.909091,0;6.13636,0.909091,0;6.36364,0.909091,0;6.59091,0.909091,0;6.81818,0.909091,0;7.04545,0.909091,0;7.27273,0.909091,0;7.5,0.909091,0;7.72727,0.909091,0;7.95455,0.909091,0;8.18182,0.909091,0;8.40909,0.909091,0;8.63636,0.909091,0;8.86364,0.909091,0;9.09091,0.909091,0;9.31818,0.909091,0;9.54545,0.909091,0;9.77273,0.909091,0;10.,0.909091,0;0.,1.36364,0;0.227273,1.36364,0;0.454545,1.36364,0;0.681818,1.36364,0;0.909091,1.36364,0;1.13636,1.36364,0;1.36364,1.36364,0;1.59091,1.36364,0;1.81818,1.36364,0;2.04545,1.36364,0;2.27273,1.36364,0;2.5,1.36364,0;2.72727,1.36364,0;2.95455,1.36364,0;3.18182,1.36364,0;3.40909,1.36364,0;3.63636,1.36364,0;3.86364,1.36364,0;4.09091,1.36364,0;4.31818,1.36364,0;4.54545,1.36364,0;4.77273,1.36364,0;5.,1.36364,0;5.22727,1.36364,0;5.45455,1.36364,0;5.68182,1.36364,0;5.90909,1.36364,0;6.13636,1.36364,0;6.36364,1.36364,0;6.59091,1.36364,0;6.81818,1.36364,0;7.04545,1.36364,0;7.27273,1.36364,0;7.5,1.36364,0;7.72727,1.36364,0;7.95455,1.36364,0;8.18182,1.36364,0;8.40909,1.36364,0;8.63636,1.36364,0;8.86364,1.36364,0;9.09091,1.36364,0;9.31818,1.36364,0;9.54545,1.36364,0;9.77273,1.36364,0;10.,1.36364,0;0.,1.81818,0;0.227273,1.81818,0;0.454545,1.81818,0;0.681818,1.81818,0;0.909091,1.81818,0;1.13636,1.81818,0;1.36364,1.81818,0;1.59091,1.81818,0;1.81818,1.81818,0;2.04545,1.81818,0;2.27273,1.81818,0;2.5,1.81818,0;2.72727,1.81818,0;2.95455,1.81818,0;3.18182,1.81818,0;3.40909,1.81818,0;3.63636,1.81818,0;3.86364,1.81818,0;4.09091,1.81818,0;4.31818,1.81818,0;4.54545,1.81818,0;4.77273,1.81818,0;5.,1.81818,0;5.22727,1.81818,0;5.45455,1.81818,0;5.68182,1.81818,0;5.90909,1.81818,0;6.13636,1.81818,0;6.36364,1.81818,0;6.59091,1.81818,0;6.81818,1.81818,0;7.04545,1.81818,0;7.27273,1.81818,0;7.5,1.81818,0;7.72727,1.81818,0;7.95455,1.81818,0;8.18182,1.81818,0;8.40909,1.81818,0;8.63636,1.81818,0;8.86364,1.81818,0;9.09091,1.81818,0;9.31818,1.81818,0;9.54545,1.81818,0;9.77273,1.81818,0;10.,1.81818,0;0.,2.27273,0;0.227273,2.27273,0;0.454545,2.27273,0;0.681818,2.27273,0;0.909091,2.27273,0;1.13636,2.27273,0;1.36364,2.27273,0;1.59091,2.27273,0;1.81818,2.27273,0;2.04545,2.27273,0;2.27273,2.27273,0;2.5,2.27273,0;2.72727,2.27273,0;2.95455,2.27273,0;3.18182,2.27273,0;3.40909,2.27273,0;3.63636,2.27273,0;3.86364,2.27273,0;4.09091,2.27273,0;4.31818,2.27273,0;4.54545,2.27273,0;4.77273,2.27273,0;5.,2.27273,0;5.22727,2.27273,0;5.45455,2.27273,0;5.68182,2.27273,0;5.90909,2.27273,0;6.13636,2.27273,0;6.36364,2.27273,0;6.59091,2.27273,0;6.81818,2.27273,0;7.04545,2.27273,0;7.27273,2.27273,0;7.5,2.27273,0;7.72727,2.27273,0;7.95455,2.27273,0;8.18182,2.27273,0;8.40909,2.27273,0;8.63636,2.27273,0;8.86364,2.27273,0;9.09091,2.27273,0;9.31818,2.27273,0;9.54545,2.27273,0;9.77273,2.27273,0;10.,2.27273,0;0.,2.72727,0;0.227273,2.72727,0;0.454545,2.72727,0;0.681818,2.72727,0;0.909091,2.72727,0;1.13636,2.72727,0;1.36364,2.72727,0;1.59091,2.72727,0;1.81818,2.72727,0;2.04545,2.72727,0;2.27273,2.72727,0;2.5,2.72727,0;2.72727,2.72727,0;2.95455,2.72727,0;3.18182,2.72727,0;3.40909,2.72727,0;3.63636,2.72727,0;3.86364,2.72727,0;4.09091,2.72727,0;4.31818,2.72727,0;4.54545,2.72727,0;4.77273,2.72727,0;5.,2.72727,0;5.22727,2.72727,0;5.45455,2.72727,0;5.68182,2.72727,0;5.90909,2.72727,0;6.13636,2.72727,0;6.36364,2.72727,0;6.59091,2.72727,0;6.81818,2.72727,0;7.04545,2.72727,0;7.27273,2.72727,0;7.5,2.72727,0;7.72727,2.72727,0;7.95455,2.72727,0;8.18182,2.72727,0;8.40909,2.72727,0;8.63636,2.72727,0;8.86364,2.72727,0;9.09091,2.72727,0;9.31818,2.72727,0;9.54545,2.72727,0;9.77273,2.72727,0;10.,2.72727,0;0.,3.18182,0;0.227273,3.18182,0;0.454545,3.18182,0;0.681818,3.18182,0;0.909091,3.18182,0;1.13636,3.18182,0;1.36364,3.18182,0;1.59091,3.18182,0;1.81818,3.18182,0;2.04545,3.18182,0;2.27273,3.18182,0;2.5,3.18182,0;2.72727,3.18182,0;2.95455,3.18182,0;3.18182,3.18182,0;3.40909,3.18182,0;3.63636,3.18182,0;3.86364,3.18182,0;4.09091,3.18182,0;4.31818,3.18182,0;4.54545,3.18182,0;4.77273,3.18182,0;5.,3.18182,0;5.22727,3.18182,0;5.45455,3.18182,0;5.68182,3.18182,0;5.90909,3.18182,0;6.13636,3.18182,0;6.36364,3.18182,0;6.59091,3.18182,0;6.81818,3.18182,0;7.04545,3.18182,0;7.27273,3.18182,0;7.5,3.18182,0;7.72727,3.18182,0;7.95455,3.18182,0;8.18182,3.18182,0;8.40909,3.18182,0;8.63636,3.18182,0;8.86364,3.18182,0;9.09091,3.18182,0;9.31818,3.18182,0;9.54545,3.18182,0;9.77273,3.18182,0;10.,3.18182,0;0.,3.63636,0;0.227273,3.63636,0;0.454545,3.63636,0;0.681818,3.63636,0;0.909091,3.63636,0;1.13636,3.63636,0;1.36364,3.63636,0;1.59091,3.63636,0;1.81818,3.63636,0;2.04545,3.63636,0;2.27273,3.63636,0;2.5,3.63636,0;2.72727,3.63636,0;2.95455,3.63636,0;3.18182,3.63636,0;3.40909,3.63636,0;3.63636,3.63636,0;3.86364,3.63636,0;4.09091,3.63636,0;4.31818,3.63636,0;4.54545,3.63636,0;4.77273,3.63636,0;5.,3.63636,0;5.22727,3.63636,0;5.45455,3.63636,0;5.68182,3.63636,0;5.90909,3.63636,0;6.13636,3.63636,0;6.36364,3.63636,0;6.59091,3.63636,0;6.81818,3.63636,0;7.04545,3.63636,0;7.27273,3.63636,0;7.5,3.63636,0;7.72727,3.63636,0;7.95455,3.63636,0;8.18182,3.63636,0;8.40909,3.63636,0;8.63636,3.63636,0;8.86364,3.63636,0;9.09091,3.63636,0;9.31818,3.63636,0;9.54545,3.63636,0;9.77273,3.63636,0;10.,3.63636,0;0.,4.09091,0;0.227273,4.09091,0;0.454545,4.09091,0;0.681818,4.09091,0;0.909091,4.09091,0;1.13636,4.09091,0;1.36364,4.09091,0;1.59091,4.09091,0;1.81818,4.09091,0;2.04545,4.09091,0;2.27273,4.09091,0;2.5,4.09091,0;2.72727,4.09091,0;2.95455,4.09091,0;3.18182,4.09091,0;3.40909,4.09091,0;3.63636,4.09091,0;3.86364,4.09091,0;4.09091,4.09091,0;4.31818,4.09091,0;4.54545,4.09091,0;4.77273,4.09091,0;5.,4.09091,0;5.22727,4.09091,0;5.45455,4.09091,0;5.68182,4.09091,0;5.90909,4.09091,0;6.13636,4.09091,0;6.36364,4.09091,0;6.59091,4.09091,0;6.81818,4.09091,0;7.04545,4.09091,0;7.27273,4.09091,0;7.5,4.09091,0;7.72727,4.09091,0;7.95455,4.09091,0;8.18182,4.09091,0;8.40909,4.09091,0;8.63636,4.09091,0;8.86364,4.09091,0;9.09091,4.09091,0;9.31818,4.09091,0;9.54545,4.09091,0;9.77273,4.09091,0;10.,4.09091,0;0.,4.54545,0;0.227273,4.54545,0;0.454545,4.54545,0;0.681818,4.54545,0;0.909091,4.54545,0;1.13636,4.54545,0;1.36364,4.54545,0;1.59091,4.54545,0;1.81818,4.54545,0;2.04545,4.54545,0;2.27273,4.54545,0;2.5,4.54545,0;2.72727,4.54545,0;2.95455,4.54545,0;3.18182,4.54545,0;3.40909,4.54545,0;3.63636,4.54545,0;3.86364,4.54545,0;4.09091,4.54545,0;4.31818,4.54545,0;4.54545,4.54545,0;4.77273,4.54545,0;5.,4.54545,0;5.22727,4.54545,0;5.45455,4.54545,0;5.68182,4.54545,0;5.90909,4.54545,0;6.13636,4.54545,0;6.36364,4.54545,0;6.59091,4.54545,0;6.81818,4.54545,0;7.04545,4.54545,0;7.27273,4.54545,0;7.5,4.54545,0;7.72727,4.54545,0;7.95455,4.54545,0;8.18182,4.54545,0;8.40909,4.54545,0;8.63636,4.54545,0;8.86364,4.54545,0;9.09091,4.54545,0;9.31818,4.54545,0;9.54545,4.54545,0;9.77273,4.54545,0;10.,4.54545,0;0.,5.,0;0.227273,5.,0;0.454545,5.,0;0.681818,5.,0;0.909091,5.,0;1.13636,5.,0;1.36364,5.,0;1.59091,5.,0;1.81818,5.,0;2.04545,5.,0;2.27273,5.,0;2.5,5.,0;2.72727,5.,0;2.95455,5.,0;3.18182,5.,0;3.40909,5.,0;3.63636,5.,0;3.86364,5.,0;4.09091,5.,0;4.31818,5.,0;4.54545,5.,0;4.77273,5.,0;5.,5.,0;5.22727,5.,0;5.45455,5.,0;5.68182,5.,0;5.90909,5.,0;6.13636,5.,0;6.36364,5.,0;6.59091,5.,0;6.81818,5.,0;7.04545,5.,0;7.27273,5.,0;7.5,5.,0;7.72727,5.,0;7.95455,5.,0;8.18182,5.,0;8.40909,5.,0;8.63636,5.,0;8.86364,5.,0;9.09091,5.,0;9.31818,5.,0;9.54545,5.,0;9.77273,5.,0;10.,5.,0;0.,5.45455,0;0.227273,5.45455,0;0.454545,5.45455,0;0.681818,5.45455,0;0.909091,5.45455,0;1.13636,5.45455,0;1.36364,5.45455,0;1.59091,5.45455,0;1.81818,5.45455,0;2.04545,5.45455,0;2.27273,5.45455,0;2.5,5.45455,0;2.72727,5.45455,0;2.95455,5.45455,0;3.18182,5.45455,0;3.40909,5.45455,0;3.63636,5.45455,0;3.86364,5.45455,0;4.09091,5.45455,0;4.31818,5.45455,0;4.54545,5.45455,0;4.77273,5.45455,0;5.,5.45455,0;5.22727,5.45455,0;5.45455,5.45455,0;5.68182,5.45455,0;5.90909,5.45455,0;6.13636,5.45455,0;6.36364,5.45455,0;6.59091,5.45455,0;6.81818,5.45455,0;7.04545,5.45455,0;7.27273,5.45455,0;7.5,5.45455,0;7.72727,5.45455,0;7.95455,5.45455,0;8.18182,5.45455,0;8.40909,5.45455,0;8.63636,5.45455,0;8.86364,5.45455,0;9.09091,5.45455,0;9.31818,5.45455,0;9.54545,5.45455,0;9.77273,5.45455,0;10.,5.45455,0;0.,5.90909,0;0.227273,5.90909,0;0.454545,5.90909,0;0.681818,5.90909,0;0.909091,5.90909,0;1.13636,5.90909,0;1.36364,5.90909,0;1.59091,5.90909,0;1.81818,5.90909,0;2.04545,5.90909,0;2.27273,5.90909,0;2.5,5.90909,0;2.72727,5.90909,0;2.95455,5.90909,0;3.18182,5.90909,0;3.40909,5.90909,0;3.63636,5.90909,0;3.86364,5.90909,0;4.09091,5.90909,0;4.31818,5.90909,0;4.54545,5.90909,0;4.77273,5.90909,0;5.,5.90909,0;5.22727,5.90909,0;5.45455,5.90909,0;5.68182,5.90909,0;5.90909,5.90909,0;6.13636,5.90909,0;6.36364,5.90909,0;6.59091,5.90909,0;6.81818,5.90909,0;7.04545,5.90909,0;7.27273,5.90909,0;7.5,5.90909,0;7.72727,5.90909,0;7.95455,5.90909,0;8.18182,5.90909,0;8.40909,5.90909,0;8.63636,5.90909,0;8.86364,5.90909,0;9.09091,5.90909,0;9.31818,5.90909,0;9.54545,5.90909,0;9.77273,5.90909,0;10.,5.90909,0;0.,6.36364,0;0.227273,6.36364,0;0.454545,6.36364,0;0.681818,6.36364,0;0.909091,6.36364,0;1.13636,6.36364,0;1.36364,6.36364,0;1.59091,6.36364,0;1.81818,6.36364,0;2.04545,6.36364,0;2.27273,6.36364,0;2.5,6.36364,0;2.72727,6.36364,0;2.95455,6.36364,0;3.18182,6.36364,0;3.40909,6.36364,0;3.63636,6.36364,0;3.86364,6.36364,0;4.09091,6.36364,0;4.31818,6.36364,0;4.54545,6.36364,0;4.77273,6.36364,0;5.,6.36364,0;5.22727,6.36364,0;5.45455,6.36364,0;5.68182,6.36364,0;5.90909,6.36364,0;6.13636,6.36364,0;6.36364,6.36364,0;6.59091,6.36364,0;6.81818,6.36364,0;7.04545,6.36364,0;7.27273,6.36364,0;7.5,6.36364,0;7.72727,6.36364,0;7.95455,6.36364,0;8.18182,6.36364,0;8.40909,6.36364,0;8.63636,6.36364,0;8.86364,6.36364,0;9.09091,6.36364,0;9.31818,6.36364,0;9.54545,6.36364,0;9.77273,6.36364,0;10.,6.36364,0;0.,6.81818,0;0.227273,6.81818,0;0.454545,6.81818,0;0.681818,6.81818,0;0.909091,6.81818,0;1.13636,6.81818,0;1.36364,6.81818,0;1.59091,6.81818,0;1.81818,6.81818,0;2.04545,6.81818,0;2.27273,6.81818,0;2.5,6.81818,0;2.72727,6.81818,0;2.95455,6.81818,0;3.18182,6.81818,0;3.40909,6.81818,0;3.63636,6.81818,0;3.86364,6.81818,0;4.09091,6.81818,0;4.31818,6.81818,0;4.54545,6.81818,0;4.77273,6.81818,0;5.,6.81818,0;5.22727,6.81818,0;5.45455,6.81818,0;5.68182,6.81818,0;5.90909,6.81818,0;6.13636,6.81818,0;6.36364,6.81818,0;6.59091,6.81818,0;6.81818,6.81818,0;7.04545,6.81818,0;7.27273,6.81818,0;7.5,6.81818,0;7.72727,6.81818,0;7.95455,6.81818,0;8.18182,6.81818,0;8.40909,6.81818,0;8.63636,6.81818,0;8.86364,6.81818,0;9.09091,6.81818,0;9.31818,6.81818,0;9.54545,6.81818,0;9.77273,6.81818,0;10.,6.81818,0;0.,7.27273,0;0.227273,7.27273,0;0.454545,7.27273,0;0.681818,7.27273,0;0.909091,7.27273,0;1.13636,7.27273,0;1.36364,7.27273,0;1.59091,7.27273,0;1.81818,7.27273,0;2.04545,7.27273,0;2.27273,7.27273,0;2.5,7.27273,0;2.72727,7.27273,0;2.95455,7.27273,0;3.18182,7.27273,0;3.40909,7.27273,0;3.63636,7.27273,0;3.86364,7.27273,0;4.09091,7.27273,0;4.31818,7.27273,0;4.54545,7.27273,0;4.77273,7.27273,0;5.,7.27273,0;5.22727,7.27273,0;5.45455,7.27273,0;5.68182,7.27273,0;5.90909,7.27273,0;6.13636,7.27273,0;6.36364,7.27273,0;6.59091,7.27273,0;6.81818,7.27273,0;7.04545,7.27273,0;7.27273,7.27273,0;7.5,7.27273,0;7.72727,7.27273,0;7.95455,7.27273,0;8.18182,7.27273,0;8.40909,7.27273,0;8.63636,7.27273,0;8.86364,7.27273,0;9.09091,7.27273,0;9.31818,7.27273,0;9.54545,7.27273,0;9.77273,7.27273,0;10.,7.27273,0;0.,7.72727,0;0.227273,7.72727,0;0.454545,7.72727,0;0.681818,7.72727,0;0.909091,7.72727,0;1.13636,7.72727,0;1.36364,7.72727,0;1.59091,7.72727,0;1.81818,7.72727,0;2.04545,7.72727,0;2.27273,7.72727,0;2.5,7.72727,0;2.72727,7.72727,0;2.95455,7.72727,0;3.18182,7.72727,0;3.40909,7.72727,0;3.63636,7.72727,0;3.86364,7.72727,0;4.09091,7.72727,0;4.31818,7.72727,0;4.54545,7.72727,0;4.77273,7.72727,0;5.,7.72727,0;5.22727,7.72727,0;5.45455,7.72727,0;5.68182,7.72727,0;5.90909,7.72727,0;6.13636,7.72727,0;6.36364,7.72727,0;6.59091,7.72727,0;6.81818,7.72727,0;7.04545,7.72727,0;7.27273,7.72727,0;7.5,7.72727,0;7.72727,7.72727,0;7.95455,7.72727,0;8.18182,7.72727,0;8.40909,7.72727,0;8.63636,7.72727,0;8.86364,7.72727,0;9.09091,7.72727,0;9.31818,7.72727,0;9.54545,7.72727,0;9.77273,7.72727,0;10.,7.72727,0;0.,8.18182,0;0.227273,8.18182,0;0.454545,8.18182,0;0.681818,8.18182,0;0.909091,8.18182,0;1.13636,8.18182,0;1.36364,8.18182,0;1.59091,8.18182,0;1.81818,8.18182,0;2.04545,8.18182,0;2.27273,8.18182,0;2.5,8.18182,0;2.72727,8.18182,0;2.95455,8.18182,0;3.18182,8.18182,0;3.40909,8.18182,0;3.63636,8.18182,0;3.86364,8.18182,0;4.09091,8.18182,0;4.31818,8.18182,0;4.54545,8.18182,0;4.77273,8.18182,0;5.,8.18182,0;5.22727,8.18182,0;5.45455,8.18182,0;5.68182,8.18182,0;5.90909,8.18182,0;6.13636,8.18182,0;6.36364,8.18182,0;6.59091,8.18182,0;6.81818,8.18182,0;7.04545,8.18182,0;7.27273,8.18182,0;7.5,8.18182,0;7.72727,8.18182,0;7.95455,8.18182,0;8.18182,8.18182,0;8.40909,8.18182,0;8.63636,8.18182,0;8.86364,8.18182,0;9.09091,8.18182,0;9.31818,8.18182,0;9.54545,8.18182,0;9.77273,8.18182,0;10.,8.18182,0;0.,8.63636,0;0.227273,8.63636,0;0.454545,8.63636,0;0.681818,8.63636,0;0.909091,8.63636,0;1.13636,8.63636,0;1.36364,8.63636,0;1.59091,8.63636,0;1.81818,8.63636,0;2.04545,8.63636,0;2.27273,8.63636,0;2.5,8.63636,0;2.72727,8.63636,0;2.95455,8.63636,0;3.18182,8.63636,0;3.40909,8.63636,0;3.63636,8.63636,0;3.86364,8.63636,0;4.09091,8.63636,0;4.31818,8.63636,0;4.54545,8.63636,0;4.77273,8.63636,0;5.,8.63636,0;5.22727,8.63636,0;5.45455,8.63636,0;5.68182,8.63636,0;5.90909,8.63636,0;6.13636,8.63636,0;6.36364,8.63636,0;6.59091,8.63636,0;6.81818,8.63636,0;7.04545,8.63636,0;7.27273,8.63636,0;7.5,8.63636,0;7.72727,8.63636,0;7.95455,8.63636,0;8.18182,8.63636,0;8.40909,8.63636,0;8.63636,8.63636,0;8.86364,8.63636,0;9.09091,8.63636,0;9.31818,8.63636,0;9.54545,8.63636,0;9.77273,8.63636,0;10.,8.63636,0;0.,9.09091,0;0.227273,9.09091,0;0.454545,9.09091,0;0.681818,9.09091,0;0.909091,9.09091,0;1.13636,9.09091,0;1.36364,9.09091,0;1.59091,9.09091,0;1.81818,9.09091,0;2.04545,9.09091,0;2.27273,9.09091,0;2.5,9.09091,0;2.72727,9.09091,0;2.95455,9.09091,0;3.18182,9.09091,0;3.40909,9.09091,0;3.63636,9.09091,0;3.86364,9.09091,0;4.09091,9.09091,0;4.31818,9.09091,0;4.54545,9.09091,0;4.77273,9.09091,0;5.,9.09091,0;5.22727,9.09091,0;5.45455,9.09091,0;5.68182,9.09091,0;5.90909,9.09091,0;6.13636,9.09091,0;6.36364,9.09091,0;6.59091,9.09091,0;6.81818,9.09091,0;7.04545,9.09091,0;7.27273,9.09091,0;7.5,9.09091,0;7.72727,9.09091,0;7.95455,9.09091,0;8.18182,9.09091,0;8.40909,9.09091,0;8.63636,9.09091,0;8.86364,9.09091,0;9.09091,9.09091,0;9.31818,9.09091,0;9.54545,9.09091,0;9.77273,9.09091,0;10.,9.09091,0;0.,9.54545,0;0.227273,9.54545,0;0.454545,9.54545,0;0.681818,9.54545,0;0.909091,9.54545,0;1.13636,9.54545,0;1.36364,9.54545,0;1.59091,9.54545,0;1.81818,9.54545,0;2.04545,9.54545,0;2.27273,9.54545,0;2.5,9.54545,0;2.72727,9.54545,0;2.95455,9.54545,0;3.18182,9.54545,0;3.40909,9.54545,0;3.63636,9.54545,0;3.86364,9.54545,0;4.09091,9.54545,0;4.31818,9.54545,0;4.54545,9.54545,0;4.77273,9.54545,0;5.,9.54545,0;5.22727,9.54545,0;5.45455,9.54545,0;5.68182,9.54545,0;5.90909,9.54545,0;6.13636,9.54545,0;6.36364,9.54545,0;6.59091,9.54545,0;6.81818,9.54545,0;7.04545,9.54545,0;7.27273,9.54545,0;7.5,9.54545,0;7.72727,9.54545,0;7.95455,9.54545,0;8.18182,9.54545,0;8.40909,9.54545,0;8.63636,9.54545,0;8.86364,9.54545,0;9.09091,9.54545,0;9.31818,9.54545,0;9.54545,9.54545,0;9.77273,9.54545,0;10.,9.54545,0;0.,10.,0;0.227273,10.,0;0.454545,10.,0;0.681818,10.,0;0.909091,10.,0;1.13636,10.,0;1.36364,10.,0;1.59091,10.,0;1.81818,10.,0;2.04545,10.,0;2.27273,10.,0;2.5,10.,0;2.72727,10.,0;2.95455,10.,0;3.18182,10.,0;3.40909,10.,0;3.63636,10.,0;3.86364,10.,0;4.09091,10.,0;4.31818,10.,0;4.54545,10.,0;4.77273,10.,0;5.,10.,0;5.22727,10.,0;5.45455,10.,0;5.68182,10.,0;5.90909,10.,0;6.13636,10.,0;6.36364,10.,0;6.59091,10.,0;6.81818,10.,0;7.04545,10.,0;7.27273,10.,0;7.5,10.,0;7.72727,10.,0;7.95455,10.,0;8.18182,10.,0;8.40909,10.,0;8.63636,10.,0;8.86364,10.,0;9.09091,10.,0;9.31818,10.,0;9.54545,10.,0;9.77273,10.,0;10.,10.,0;0.,0.227273,0;0.454545,0.227273,0;0.909091,0.227273,0;1.36364,0.227273,0;1.81818,0.227273,0;2.27273,0.227273,0;2.72727,0.227273,0;3.18182,0.227273,0;3.63636,0.227273,0;4.09091,0.227273,0;4.54545,0.227273,0;5.,0.227273,0;5.45455,0.227273,0;5.90909,0.227273,0;6.36364,0.227273,0;6.81818,0.227273,0;7.27273,0.227273,0;7.72727,0.227273,0;8.18182,0.227273,0;8.63636,0.227273,0;9.09091,0.227273,0;9.54545,0.227273,0;10.,0.227273,0;0.,0.681818,0;0.454545,0.681818,0;0.909091,0.681818,0;1.36364,0.681818,0;1.81818,0.681818,0;2.27273,0.681818,0;2.72727,0.681818,0;3.18182,0.681818,0;3.63636,0.681818,0;4.09091,0.681818,0;4.54545,0.681818,0;5.,0.681818,0;5.45455,0.681818,0;5.90909,0.681818,0;6.36364,0.681818,0;6.81818,0.681818,0;7.27273,0.681818,0;7.72727,0.681818,0;8.18182,0.681818,0;8.63636,0.681818,0;9.09091,0.681818,0;9.54545,0.681818,0;10.,0.681818,0;0.,1.13636,0;0.454545,1.13636,0;0.909091,1.13636,0;1.36364,1.13636,0;1.81818,1.13636,0;2.27273,1.13636,0;2.72727,1.13636,0;3.18182,1.13636,0;3.63636,1.13636,0;4.09091,1.13636,0;4.54545,1.13636,0;5.,1.13636,0;5.45455,1.13636,0;5.90909,1.13636,0;6.36364,1.13636,0;6.81818,1.13636,0;7.27273,1.13636,0;7.72727,1.13636,0;8.18182,1.13636,0;8.63636,1.13636,0;9.09091,1.13636,0;9.54545,1.13636,0;10.,1.13636,0;0.,1.59091,0;0.454545,1.59091,0;0.909091,1.59091,0;1.36364,1.59091,0;1.81818,1.59091,0;2.27273,1.59091,0;2.72727,1.59091,0;3.18182,1.59091,0;3.63636,1.59091,0;4.09091,1.59091,0;4.54545,1.59091,0;5.,1.59091,0;5.45455,1.59091,0;5.90909,1.59091,0;6.36364,1.59091,0;6.81818,1.59091,0;7.27273,1.59091,0;7.72727,1.59091,0;8.18182,1.59091,0;8.63636,1.59091,0;9.09091,1.59091,0;9.54545,1.59091,0;10.,1.59091,0;0.,2.04545,0;0.454545,2.04545,0;0.909091,2.04545,0;1.36364,2.04545,0;1.81818,2.04545,0;2.27273,2.04545,0;2.72727,2.04545,0;3.18182,2.04545,0;3.63636,2.04545,0;4.09091,2.04545,0;4.54545,2.04545,0;5.,2.04545,0;5.45455,2.04545,0;5.90909,2.04545,0;6.36364,2.04545,0;6.81818,2.04545,0;7.27273,2.04545,0;7.72727,2.04545,0;8.18182,2.04545,0;8.63636,2.04545,0;9.09091,2.04545,0;9.54545,2.04545,0;10.,2.04545,0;0.,2.5,0;0.454545,2.5,0;0.909091,2.5,0;1.36364,2.5,0;1.81818,2.5,0;2.27273,2.5,0;2.72727,2.5,0;3.18182,2.5,0;3.63636,2.5,0;4.09091,2.5,0;4.54545,2.5,0;5.,2.5,0;5.45455,2.5,0;5.90909,2.5,0;6.36364,2.5,0;6.81818,2.5,0;7.27273,2.5,0;7.72727,2.5,0;8.18182,2.5,0;8.63636,2.5,0;9.09091,2.5,0;9.54545,2.5,0;10.,2.5,0;0.,2.95455,0;0.454545,2.95455,0;0.909091,2.95455,0;1.36364,2.95455,0;1.81818,2.95455,0;2.27273,2.95455,0;2.72727,2.95455,0;3.18182,2.95455,0;3.63636,2.95455,0;4.09091,2.95455,0;4.54545,2.95455,0;5.,2.95455,0;5.45455,2.95455,0;5.90909,2.95455,0;6.36364,2.95455,0;6.81818,2.95455,0;7.27273,2.95455,0;7.72727,2.95455,0;8.18182,2.95455,0;8.63636,2.95455,0;9.09091,2.95455,0;9.54545,2.95455,0;10.,2.95455,0;0.,3.40909,0;0.454545,3.40909,0;0.909091,3.40909,0;1.36364,3.40909,0;1.81818,3.40909,0;2.27273,3.40909,0;2.72727,3.40909,0;3.18182,3.40909,0;3.63636,3.40909,0;4.09091,3.40909,0;4.54545,3.40909,0;5.,3.40909,0;5.45455,3.40909,0;5.90909,3.40909,0;6.36364,3.40909,0;6.81818,3.40909,0;7.27273,3.40909,0;7.72727,3.40909,0;8.18182,3.40909,0;8.63636,3.40909,0;9.09091,3.40909,0;9.54545,3.40909,0;10.,3.40909,0;0.,3.86364,0;0.454545,3.86364,0;0.909091,3.86364,0;1.36364,3.86364,0;1.81818,3.86364,0;2.27273,3.86364,0;2.72727,3.86364,0;3.18182,3.86364,0;3.63636,3.86364,0;4.09091,3.86364,0;4.54545,3.86364,0;5.,3.86364,0;5.45455,3.86364,0;5.90909,3.86364,0;6.36364,3.86364,0;6.81818,3.86364,0;7.27273,3.86364,0;7.72727,3.86364,0;8.18182,3.86364,0;8.63636,3.86364,0;9.09091,3.86364,0;9.54545,3.86364,0;10.,3.86364,0;0.,4.31818,0;0.454545,4.31818,0;0.909091,4.31818,0;1.36364,4.31818,0;1.81818,4.31818,0;2.27273,4.31818,0;2.72727,4.31818,0;3.18182,4.31818,0;3.63636,4.31818,0;4.09091,4.31818,0;4.54545,4.31818,0;5.,4.31818,0;5.45455,4.31818,0;5.90909,4.31818,0;6.36364,4.31818,0;6.81818,4.31818,0;7.27273,4.31818,0;7.72727,4.31818,0;8.18182,4.31818,0;8.63636,4.31818,0;9.09091,4.31818,0;9.54545,4.31818,0;10.,4.31818,0;0.,4.77273,0;0.454545,4.77273,0;0.909091,4.77273,0;1.36364,4.77273,0;1.81818,4.77273,0;2.27273,4.77273,0;2.72727,4.77273,0;3.18182,4.77273,0;3.63636,4.77273,0;4.09091,4.77273,0;4.54545,4.77273,0;5.,4.77273,0;5.45455,4.77273,0;5.90909,4.77273,0;6.36364,4.77273,0;6.81818,4.77273,0;7.27273,4.77273,0;7.72727,4.77273,0;8.18182,4.77273,0;8.63636,4.77273,0;9.09091,4.77273,0;9.54545,4.77273,0;10.,4.77273,0;0.,5.22727,0;0.454545,5.22727,0;0.909091,5.22727,0;1.36364,5.22727,0;1.81818,5.22727,0;2.27273,5.22727,0;2.72727,5.22727,0;3.18182,5.22727,0;3.63636,5.22727,0;4.09091,5.22727,0;4.54545,5.22727,0;5.,5.22727,0;5.45455,5.22727,0;5.90909,5.22727,0;6.36364,5.22727,0;6.81818,5.22727,0;7.27273,5.22727,0;7.72727,5.22727,0;8.18182,5.22727,0;8.63636,5.22727,0;9.09091,5.22727,0;9.54545,5.22727,0;10.,5.22727,0;0.,5.68182,0;0.454545,5.68182,0;0.909091,5.68182,0;1.36364,5.68182,0;1.81818,5.68182,0;2.27273,5.68182,0;2.72727,5.68182,0;3.18182,5.68182,0;3.63636,5.68182,0;4.09091,5.68182,0;4.54545,5.68182,0;5.,5.68182,0;5.45455,5.68182,0;5.90909,5.68182,0;6.36364,5.68182,0;6.81818,5.68182,0;7.27273,5.68182,0;7.72727,5.68182,0;8.18182,5.68182,0;8.63636,5.68182,0;9.09091,5.68182,0;9.54545,5.68182,0;10.,5.68182,0;0.,6.13636,0;0.454545,6.13636,0;0.909091,6.13636,0;1.36364,6.13636,0;1.81818,6.13636,0;2.27273,6.13636,0;2.72727,6.13636,0;3.18182,6.13636,0;3.63636,6.13636,0;4.09091,6.13636,0;4.54545,6.13636,0;5.,6.13636,0;5.45455,6.13636,0;5.90909,6.13636,0;6.36364,6.13636,0;6.81818,6.13636,0;7.27273,6.13636,0;7.72727,6.13636,0;8.18182,6.13636,0;8.63636,6.13636,0;9.09091,6.13636,0;9.54545,6.13636,0;10.,6.13636,0;0.,6.59091,0;0.454545,6.59091,0;0.909091,6.59091,0;1.36364,6.59091,0;1.81818,6.59091,0;2.27273,6.59091,0;2.72727,6.59091,0;3.18182,6.59091,0;3.63636,6.59091,0;4.09091,6.59091,0;4.54545,6.59091,0;5.,6.59091,0;5.45455,6.59091,0;5.90909,6.59091,0;6.36364,6.59091,0;6.81818,6.59091,0;7.27273,6.59091,0;7.72727,6.59091,0;8.18182,6.59091,0;8.63636,6.59091,0;9.09091,6.59091,0;9.54545,6.59091,0;10.,6.59091,0;0.,7.04545,0;0.454545,7.04545,0;0.909091,7.04545,0;1.36364,7.04545,0;1.81818,7.04545,0;2.27273,7.04545,0;2.72727,7.04545,0;3.18182,7.04545,0;3.63636,7.04545,0;4.09091,7.04545,0;4.54545,7.04545,0;5.,7.04545,0;5.45455,7.04545,0;5.90909,7.04545,0;6.36364,7.04545,0;6.81818,7.04545,0;7.27273,7.04545,0;7.72727,7.04545,0;8.18182,7.04545,0;8.63636,7.04545,0;9.09091,7.04545,0;9.54545,7.04545,0;10.,7.04545,0;0.,7.5,0;0.454545,7.5,0;0.909091,7.5,0;1.36364,7.5,0;1.81818,7.5,0;2.27273,7.5,0;2.72727,7.5,0;3.18182,7.5,0;3.63636,7.5,0;4.09091,7.5,0;4.54545,7.5,0;5.,7.5,0;5.45455,7.5,0;5.90909,7.5,0;6.36364,7.5,0;6.81818,7.5,0;7.27273,7.5,0;7.72727,7.5,0;8.18182,7.5,0;8.63636,7.5,0;9.09091,7.5,0;9.54545,7.5,0;10.,7.5,0;0.,7.95455,0;0.454545,7.95455,0;0.909091,7.95455,0;1.36364,7.95455,0;1.81818,7.95455,0;2.27273,7.95455,0;2.72727,7.95455,0;3.18182,7.95455,0;3.63636,7.95455,0;4.09091,7.95455,0;4.54545,7.95455,0;5.,7.95455,0;5.45455,7.95455,0;5.90909,7.95455,0;6.36364,7.95455,0;6.81818,7.95455,0;7.27273,7.95455,0;7.72727,7.95455,0;8.18182,7.95455,0;8.63636,7.95455,0;9.09091,7.95455,0;9.54545,7.95455,0;10.,7.95455,0;0.,8.40909,0;0.454545,8.40909,0;0.909091,8.40909,0;1.36364,8.40909,0;1.81818,8.40909,0;2.27273,8.40909,0;2.72727,8.40909,0;3.18182,8.40909,0;3.63636,8.40909,0;4.09091,8.40909,0;4.54545,8.40909,0;5.,8.40909,0;5.45455,8.40909,0;5.90909,8.40909,0;6.36364,8.40909,0;6.81818,8.40909,0;7.27273,8.40909,0;7.72727,8.40909,0;8.18182,8.40909,0;8.63636,8.40909,0;9.09091,8.40909,0;9.54545,8.40909,0;10.,8.40909,0;0.,8.86364,0;0.454545,8.86364,0;0.909091,8.86364,0;1.36364,8.86364,0;1.81818,8.86364,0;2.27273,8.86364,0;2.72727,8.86364,0;3.18182,8.86364,0;3.63636,8.86364,0;4.09091,8.86364,0;4.54545,8.86364,0;5.,8.86364,0;5.45455,8.86364,0;5.90909,8.86364,0;6.36364,8.86364,0;6.81818,8.86364,0;7.27273,8.86364,0;7.72727,8.86364,0;8.18182,8.86364,0;8.63636,8.86364,0;9.09091,8.86364,0;9.54545,8.86364,0;10.,8.86364,0;0.,9.31818,0;0.454545,9.31818,0;0.909091,9.31818,0;1.36364,9.31818,0;1.81818,9.31818,0;2.27273,9.31818,0;2.72727,9.31818,0;3.18182,9.31818,0;3.63636,9.31818,0;4.09091,9.31818,0;4.54545,9.31818,0;5.,9.31818,0;5.45455,9.31818,0;5.90909,9.31818,0;6.36364,9.31818,0;6.81818,9.31818,0;7.27273,9.31818,0;7.72727,9.31818,0;8.18182,9.31818,0;8.63636,9.31818,0;9.09091,9.31818,0;9.54545,9.31818,0;10.,9.31818,0;0.,9.77273,0;0.454545,9.77273,0;0.909091,9.77273,0;1.36364,9.77273,0;1.81818,9.77273,0;2.27273,9.77273,0;2.72727,9.77273,0;3.18182,9.77273,0;3.63636,9.77273,0;4.09091,9.77273,0;4.54545,9.77273,0;5.,9.77273,0;5.45455,9.77273,0;5.90909,9.77273,0;6.36364,9.77273,0;6.81818,9.77273,0;7.27273,9.77273,0;7.72727,9.77273,0;8.18182,9.77273,0;8.63636,9.77273,0;9.09091,9.77273,0;9.54545,9.77273,0;10.,9.77273,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,1037,48,47,46,1036;46,47,48,1060,93,92,91,1059;91,92,93,1083,138,137,136,1082;136,137,138,1106,183,182,181,1105;181,182,183,1129,228,227,226,1128;226,227,228,1152,273,272,271,1151;271,272,273,1175,318,317,316,1174;316,317,318,1198,363,362,361,1197;361,362,363,1221,408,407,406,1220;406,407,408,1244,453,452,451,1243;451,452,453,1267,498,497,496,1266;496,497,498,1290,543,542,541,1289;541,542,543,1313,588,587,586,1312;586,587,588,1336,633,632,631,1335;631,632,633,1359,678,677,676,1358;676,677,678,1382,723,722,721,1381;721,722,723,1405,768,767,766,1404;766,767,768,1428,813,812,811,1427;811,812,813,1451,858,857,856,1450;856,857,858,1474,903,902,901,1473;901,902,903,1497,948,947,946,1496;946,947,948,1520,993,992,991,1519;3,4,5,1038,50,49,48,1037;48,49,50,1061,95,94,93,1060;93,94,95,1084,140,139,138,1083;138,139,140,1107,185,184,183,1106;183,184,185,1130,230,229,228,1129;228,229,230,1153,275,274,273,1152;273,274,275,1176,320,319,318,1175;318,319,320,1199,365,364,363,1198;363,364,365,1222,410,409,408,1221;408,409,410,1245,455,454,453,1244;453,454,455,1268,500,499,498,1267;498,499,500,1291,545,544,543,1290;543,544,545,1314,590,589,588,1313;588,589,590,1337,635,634,633,1336;633,634,635,1360,680,679,678,1359;678,679,680,1383,725,724,723,1382;723,724,725,1406,770,769,768,1405;768,769,770,1429,815,814,813,1428;813,814,815,1452,860,859,858,1451;858,859,860,1475,905,904,903,1474;903,904,905,1498,950,949,948,1497;948,949,950,1521,995,994,993,1520;5,6,7,1039,52,51,50,1038;50,51,52,1062,97,96,95,1061;95,96,97,1085,142,141,140,1084;140,141,142,1108,187,186,185,1107;185,186,187,1131,232,231,230,1130;230,231,232,1154,277,276,275,1153;275,276,277,1177,322,321,320,1176;320,321,322,1200,367,366,365,1199;365,366,367,1223,412,411,410,1222;410,411,412,1246,457,456,455,1245;455,456,457,1269,502,501,500,1268;500,501,502,1292,547,546,545,1291;545,546,547,1315,592,591,590,1314;590,591,592,1338,637,636,635,1337;635,636,637,1361,682,681,680,1360;680,681,682,1384,727,726,725,1383;725,726,727,1407,772,771,770,1406;770,771,772,1430,817,816,815,1429;815,816,817,1453,862,861,860,1452;860,861,862,1476,907,906,905,1475;905,906,907,1499,952,951,950,1498;950,951,952,1522,997,996,995,1521;7,8,9,1040,54,53,52,1039;52,53,54,1063,99,98,97,1062;97,98,99,1086,144,143,142,1085;142,143,144,1109,189,188,187,1108;187,188,189,1132,234,233,232,1131;232,233,234,1155,279,278,277,1154;277,278,279,1178,324,323,322,1177;322,323,324,1201,369,368,367,1200;367,368,369,1224,414,413,412,1223;412,413,414,1247,459,458,457,1246;457,458,459,1270,504,503,502,1269;502,503,504,1293,549,548,547,1292;547,548,549,1316,594,593,592,1315;592,593,594,1339,639,638,637,1338;637,638,639,1362,684,683,682,1361;682,683,684,1385,729,728,727,1384;727,728,729,1408,774,773,772,1407;772,773,774,1431,819,818,817,1430;817,818,819,1454,864,863,862,1453;862,863,864,1477,909,908,907,1476;907,908,909,1500,954,953,952,1499;952,953,954,1523,999,998,997,1522;9,10,11,1041,56,55,54,1040;54,55,56,1064,101,100,99,1063;99,100,101,1087,146,145,144,1086;144,145,146,1110,191,190,189,1109;189,190,191,1133,236,235,234,1132;234,235,236,1156,281,280,279,1155;279,280,281,1179,326,325,324,1178;324,325,326,1202,371,370,369,1201;369,370,371,1225,416,415,414,1224;414,415,416,1248,461,460,459,1247;459,460,461,1271,506,505,504,1270;504,505,506,1294,551,550,549,1293;549,550,551,1317,596,595,594,1316;594,595,596,1340,641,640,639,1339;639,640,641,1363,686,685,684,1362;684,685,686,1386,731,730,729,1385;729,730,731,1409,776,775,774,1408;774,775,776,1432,821,820,819,1431;819,820,821,1455,866,865,864,1454;864,865,866,1478,911,910,909,1477;909,910,911,1501,956,955,954,1500;954,955,956,1524,1001,1000,999,1523;11,12,13,1042,58,57,56,1041;56,57,58,1065,103,102,101,1064;101,102,103,1088,148,147,146,1087;146,147,148,1111,193,192,191,1110;191,192,193,1134,238,237,236,1133;236,237,238,1157,283,282,281,1156;281,282,283,1180,328,327,326,1179;326,327,328,1203,373,372,371,1202;371,372,373,1226,418,417,416,1225;416,417,418,1249,463,462,461,1248;461,462,463,1272,508,507,506,1271;506,507,508,1295,553,552,551,1294;551,552,553,1318,598,597,596,1317;596,597,598,1341,643,642,641,1340;641,642,643,1364,688,687,686,1363;686,687,688,1387,733,732,731,1386;731,732,733,1410,778,777,776,1409;776,777,778,1433,823,822,821,1432;821,822,823,1456,868,867,866,1455;866,867,868,1479,913,912,911,1478;911,912,913,1502,958,957,956,1501;956,957,958,1525,1003,1002,1001,1524;13,14,15,1043,60,59,58,1042;58,59,60,1066,105,104,103,1065;103,104,105,1089,150,149,148,1088;148,149,150,1112,195,194,193,1111;193,194,195,1135,240,239,238,1134;238,239,240,1158,285,284,283,1157;283,284,285,1181,330,329,328,1180;328,329,330,1204,375,374,373,1203;373,374,375,1227,420,419,418,1226;418,419,420,1250,465,464,463,1249;463,464,465,1273,510,509,508,1272;508,509,510,1296,555,554,553,1295;553,554,555,1319,600,599,598,1318;598,599,600,1342,645,644,643,1341;643,644,645,1365,690,689,688,1364;688,689,690,1388,735,734,733,1387;733,734,735,1411,780,779,778,1410;778,779,780,1434,825,824,823,1433;823,824,825,1457,870,869,868,1456;868,869,870,1480,915,914,913,1479;913,914,915,1503,960,959,958,1502;958,959,960,1526,1005,1004,1003,1525;15,16,17,1044,62,61,60,1043;60,61,62,1067,107,106,105,1066;105,106,107,1090,152,151,150,1089;150,151,152,1113,197,196,195,1112;195,196,197,1136,242,241,240,1135;240,241,242,1159,287,286,285,1158;285,286,287,1182,332,331,330,1181;330,331,332,1205,377,376,375,1204;375,376,377,1228,422,421,420,1227;420,421,422,1251,467,466,465,1250;465,466,467,1274,512,511,510,1273;510,511,512,1297,557,556,555,1296;555,556,557,1320,602,601,600,1319;600,601,602,1343,647,646,645,1342;645,646,647,1366,692,691,690,1365;690,691,692,1389,737,736,735,1388;735,736,737,1412,782,781,780,1411;780,781,782,1435,827,826,825,1434;825,826,827,1458,872,871,870,1457;870,871,872,1481,917,916,915,1480;915,916,917,1504,962,961,960,1503;960,961,962,1527,1007,1006,1005,1526;17,18,19,1045,64,63,62,1044;62,63,64,1068,109,108,107,1067;107,108,109,1091,154,153,152,1090;152,153,154,1114,199,198,197,1113;197,198,199,1137,244,243,242,1136;242,243,244,1160,289,288,287,1159;287,288,289,1183,334,333,332,1182;332,333,334,1206,379,378,377,1205;377,378,379,1229,424,423,422,1228;422,423,424,1252,469,468,467,1251;467,468,469,1275,514,513,512,1274;512,513,514,1298,559,558,557,1297;557,558,559,1321,604,603,602,1320;602,603,604,1344,649,648,647,1343;647,648,649,1367,694,693,692,1366;692,693,694,1390,739,738,737,1389;737,738,739,1413,784,783,782,1412;782,783,784,1436,829,828,827,1435;827,828,829,1459,874,873,872,1458;872,873,874,1482,919,918,917,1481;917,918,919,1505,964,963,962,1504;962,963,964,1528,1009,1008,1007,1527;19,20,21,1046,66,65,64,1045;64,65,66,1069,111,110,109,1068;109,110,111,1092,156,155,154,1091;154,155,156,1115,201,200,199,1114;199,200,201,1138,246,245,244,1137;244,245,246,1161,291,290,289,1160;289,290,291,1184,336,335,334,1183;334,335,336,1207,381,380,379,1206;379,380,381,1230,426,425,424,1229;424,425,426,1253,471,470,469,1252;469,470,471,1276,516,515,514,1275;514,515,516,1299,561,560,559,1298;559,560,561,1322,606,605,604,1321;604,605,606,1345,651,650,649,1344;649,650,651,1368,696,695,694,1367;694,695,696,1391,741,740,739,1390;739,740,741,1414,786,785,784,1413;784,785,786,1437,831,830,829,1436;829,830,831,1460,876,875,874,1459;874,875,876,1483,921,920,919,1482;919,920,921,1506,966,965,964,1505;964,965,966,1529,1011,1010,1009,1528;21,22,23,1047,68,67,66,1046;66,67,68,1070,113,112,111,1069;111,112,113,1093,158,157,156,1092;156,157,158,1116,203,202,201,1115;201,202,203,1139,248,247,246,1138;246,247,248,1162,293,292,291,1161;291,292,293,1185,338,337,336,1184;336,337,338,1208,383,382,381,1207;381,382,383,1231,428,427,426,1230;426,427,428,1254,473,472,471,1253;471,472,473,1277,518,517,516,1276;516,517,518,1300,563,562,561,1299;561,562,563,1323,608,607,606,1322;606,607,608,1346,653,652,651,1345;651,652,653,1369,698,697,696,1368;696,697,698,1392,743,742,741,1391;741,742,743,1415,788,787,786,1414;786,787,788,1438,833,832,831,1437;831,832,833,1461,878,877,876,1460;876,877,878,1484,923,922,921,1483;921,922,923,1507,968,967,966,1506;966,967,968,1530,1013,1012,1011,1529;23,24,25,1048,70,69,68,1047;68,69,70,1071,115,114,113,1070;113,114,115,1094,160,159,158,1093;158,159,160,1117,205,204,203,1116;203,204,205,1140,250,249,248,1139;248,249,250,1163,295,294,293,1162;293,294,295,1186,340,339,338,1185;338,339,340,1209,385,384,383,1208;383,384,385,1232,430,429,428,1231;428,429,430,1255,475,474,473,1254;473,474,475,1278,520,519,518,1277;518,519,520,1301,565,564,563,1300;563,564,565,1324,610,609,608,1323;608,609,610,1347,655,654,653,1346;653,654,655,1370,700,699,698,1369;698,699,700,1393,745,744,743,1392;743,744,745,1416,790,789,788,1415;788,789,790,1439,835,834,833,1438;833,834,835,1462,880,879,878,1461;878,879,880,1485,925,924,923,1484;923,924,925,1508,970,969,968,1507;968,969,970,1531,1015,1014,1013,1530;25,26,27,1049,72,71,70,1048;70,71,72,1072,117,116,115,1071;115,116,117,1095,162,161,160,1094;160,161,162,1118,207,206,205,1117;205,206,207,1141,252,251,250,1140;250,251,252,1164,297,296,295,1163;295,296,297,1187,342,341,340,1186;340,341,342,1210,387,386,385,1209;385,386,387,1233,432,431,430,1232;430,431,432,1256,477,476,475,1255;475,476,477,1279,522,521,520,1278;520,521,522,1302,567,566,565,1301;565,566,567,1325,612,611,610,1324;610,611,612,1348,657,656,655,1347;655,656,657,1371,702,701,700,1370;700,701,702,1394,747,746,745,1393;745,746,747,1417,792,791,790,1416;790,791,792,1440,837,836,835,1439;835,836,837,1463,882,881,880,1462;880,881,882,1486,927,926,925,1485;925,926,927,1509,972,971,970,1508;970,971,972,1532,1017,1016,1015,1531;27,28,29,1050,74,73,72,1049;72,73,74,1073,119,118,117,1072;117,118,119,1096,164,163,162,1095;162,163,164,1119,209,208,207,1118;207,208,209,1142,254,253,252,1141;252,253,254,1165,299,298,297,1164;297,298,299,1188,344,343,342,1187;342,343,344,1211,389,388,387,1210;387,388,389,1234,434,433,432,1233;432,433,434,1257,479,478,477,1256;477,478,479,1280,524,523,522,1279;522,523,524,1303,569,568,567,1302;567,568,569,1326,614,613,612,1325;612,613,614,1349,659,658,657,1348;657,658,659,1372,704,703,702,1371;702,703,704,1395,749,748,747,1394;747,748,749,1418,794,793,792,1417;792,793,794,1441,839,838,837,1440;837,838,839,1464,884,883,882,1463;882,883,884,1487,929,928,927,1486;927,928,929,1510,974,973,972,1509;972,973,974,1533,1019,1018,1017,1532;29,30,31,1051,76,75,74,1050;74,75,76,1074,121,120,119,1073;119,120,121,1097,166,165,164,1096;164,165,166,1120,211,210,209,1119;209,210,211,1143,256,255,254,1142;254,255,256,1166,301,300,299,1165;299,300,301,1189,346,345,344,1188;344,345,346,1212,391,390,389,1211;389,390,391,1235,436,435,434,1234;434,435,436,1258,481,480,479,1257;479,480,481,1281,526,525,524,1280;524,525,526,1304,571,570,569,1303;569,570,571,1327,616,615,614,1326;614,615,616,1350,661,660,659,1349;659,660,661,1373,706,705,704,1372;704,705,706,1396,751,750,749,1395;749,750,751,1419,796,795,794,1418;794,795,796,1442,841,840,839,1441;839,840,841,1465,886,885,884,1464;884,885,886,1488,931,930,929,1487;929,930,931,1511,976,975,974,1510;974,975,976,1534,1021,1020,1019,1533;31,32,33,1052,78,77,76,1051;76,77,78,1075,123,122,121,1074;121,122,123,1098,168,167,166,1097;166,167,168,1121,213,212,211,1120;211,212,213,1144,258,257,256,1143;256,257,258,1167,303,302,301,1166;301,302,303,1190,348,347,346,1189;346,347,348,1213,393,392,391,1212;391,392,393,1236,438,437,436,1235;436,437,438,1259,483,482,481,1258;481,482,483,1282,528,527,526,1281;526,527,528,1305,573,572,571,1304;571,572,573,1328,618,617,616,1327;616,617,618,1351,663,662,661,1350;661,662,663,1374,708,707,706,1373;706,707,708,1397,753,752,751,1396;751,752,753,1420,798,797,796,1419;796,797,798,1443,843,842,841,1442;841,842,843,1466,888,887,886,1465;886,887,888,1489,933,932,931,1488;931,932,933,1512,978,977,976,1511;976,977,978,1535,1023,1022,1021,1534;33,34,35,1053,80,79,78,1052;78,79,80,1076,125,124,123,1075;123,124,125,1099,170,169,168,1098;168,169,170,1122,215,214,213,1121;213,214,215,1145,260,259,258,1144;258,259,260,1168,305,304,303,1167;303,304,305,1191,350,349,348,1190;348,349,350,1214,395,394,393,1213;393,394,395,1237,440,439,438,1236;438,439,440,1260,485,484,483,1259;483,484,485,1283,530,529,528,1282;528,529,530,1306,575,574,573,1305;573,574,575,1329,620,619,618,1328;618,619,620,1352,665,664,663,1351;663,664,665,1375,710,709,708,1374;708,709,710,1398,755,754,753,1397;753,754,755,1421,800,799,798,1420;798,799,800,1444,845,844,843,1443;843,844,845,1467,890,889,888,1466;888,889,890,1490,935,934,933,1489;933,934,935,1513,980,979,978,1512;978,979,980,1536,1025,1024,1023,1535;35,36,37,1054,82,81,80,1053;80,81,82,1077,127,126,125,1076;125,126,127,1100,172,171,170,1099;170,171,172,1123,217,216,215,1122;215,216,217,1146,262,261,260,1145;260,261,262,1169,307,306,305,1168;305,306,307,1192,352,351,350,1191;350,351,352,1215,397,396,395,1214;395,396,397,1238,442,441,440,1237;440,441,442,1261,487,486,485,1260;485,486,487,1284,532,531,530,1283;530,531,532,1307,577,576,575,1306;575,576,577,1330,622,621,620,1329;620,621,622,1353,667,666,665,1352;665,666,667,1376,712,711,710,1375;710,711,712,1399,757,756,755,1398;755,756,757,1422,802,801,800,1421;800,801,802,1445,847,846,845,1444;845,846,847,1468,892,891,890,1467;890,891,892,1491,937,936,935,1490;935,936,937,1514,982,981,980,1513;980,981,982,1537,1027,1026,1025,1536;37,38,39,1055,84,83,82,1054;82,83,84,1078,129,128,127,1077;127,128,129,1101,174,173,172,1100;172,173,174,1124,219,218,217,1123;217,218,219,1147,264,263,262,1146;262,263,264,1170,309,308,307,1169;307,308,309,1193,354,353,352,1192;352,353,354,1216,399,398,397,1215;397,398,399,1239,444,443,442,1238;442,443,444,1262,489,488,487,1261;487,488,489,1285,534,533,532,1284;532,533,534,1308,579,578,577,1307;577,578,579,1331,624,623,622,1330;622,623,624,1354,669,668,667,1353;667,668,669,1377,714,713,712,1376;712,713,714,1400,759,758,757,1399;757,758,759,1423,804,803,802,1422;802,803,804,1446,849,848,847,1445;847,848,849,1469,894,893,892,1468;892,893,894,1492,939,938,937,1491;937,938,939,1515,984,983,982,1514;982,983,984,1538,1029,1028,1027,1537;39,40,41,1056,86,85,84,1055;84,85,86,1079,131,130,129,1078;129,130,131,1102,176,175,174,1101;174,175,176,1125,221,220,219,1124;219,220,221,1148,266,265,264,1147;264,265,266,1171,311,310,309,1170;309,310,311,1194,356,355,354,1193;354,355,356,1217,401,400,399,1216;399,400,401,1240,446,445,444,1239;444,445,446,1263,491,490,489,1262;489,490,491,1286,536,535,534,1285;534,535,536,1309,581,580,579,1308;579,580,581,1332,626,625,624,1331;624,625,626,1355,671,670,669,1354;669,670,671,1378,716,715,714,1377;714,715,716,1401,761,760,759,1400;759,760,761,1424,806,805,804,1423;804,805,806,1447,851,850,849,1446;849,850,851,1470,896,895,894,1469;894,895,896,1493,941,940,939,1492;939,940,941,1516,986,985,984,1515;984,985,986,1539,1031,1030,1029,1538;41,42,43,1057,88,87,86,1056;86,87,88,1080,133,132,131,1079;131,132,133,1103,178,177,176,1102;176,177,178,1126,223,222,221,1125;221,222,223,1149,268,267,266,1148;266,267,268,1172,313,312,311,1171;311,312,313,1195,358,357,356,1194;356,357,358,1218,403,402,401,1217;401,402,403,1241,448,447,446,1240;446,447,448,1264,493,492,491,1263;491,492,493,1287,538,537,536,1286;536,537,538,1310,583,582,581,1309;581,582,583,1333,628,627,626,1332;626,627,628,1356,673,672,671,1355;671,672,673,1379,718,717,716,1378;716,717,718,1402,763,762,761,1401;761,762,763,1425,808,807,806,1424;806,807,808,1448,853,852,851,1447;851,852,853,1471,898,897,896,1470;896,897,898,1494,943,942,941,1493;941,942,943,1517,988,987,986,1516;986,987,988,1540,1033,1032,1031,1539;43,44,45,1058,90,89,88,1057;88,89,90,1081,135,134,133,1080;133,134,135,1104,180,179,178,1103;178,179,180,1127,225,224,223,1126;223,224,225,1150,270,269,268,1149;268,269,270,1173,315,314,313,1172;313,314,315,1196,360,359,358,1195;358,359,360,1219,405,404,403,1218;403,404,405,1242,450,449,448,1241;448,449,450,1265,495,494,493,1264;493,494,495,1288,540,539,538,1287;538,539,540,1311,585,584,583,1310;583,584,585,1334,630,629,628,1333;628,629,630,1357,675,674,673,1356;673,674,675,1380,720,719,718,1379;718,719,720,1403,765,764,763,1402;763,764,765,1426,810,809,808,1425;808,809,810,1449,855,854,853,1448;853,854,855,1472,900,899,898,1471;898,899,900,1495,945,944,943,1494;943,944,945,1518,990,989,988,1517;988,989,990,1541,1035,1034,1033,1540];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];