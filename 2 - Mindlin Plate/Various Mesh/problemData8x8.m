% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=8;ney=8;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.625,0.,0;1.25,0.,0;1.875,0.,0;2.5,0.,0;3.125,0.,0;3.75,0.,0;4.375,0.,0;5.,0.,0;5.625,0.,0;6.25,0.,0;6.875,0.,0;7.5,0.,0;8.125,0.,0;8.75,0.,0;9.375,0.,0;10.,0.,0;0.,1.25,0;0.625,1.25,0;1.25,1.25,0;1.875,1.25,0;2.5,1.25,0;3.125,1.25,0;3.75,1.25,0;4.375,1.25,0;5.,1.25,0;5.625,1.25,0;6.25,1.25,0;6.875,1.25,0;7.5,1.25,0;8.125,1.25,0;8.75,1.25,0;9.375,1.25,0;10.,1.25,0;0.,2.5,0;0.625,2.5,0;1.25,2.5,0;1.875,2.5,0;2.5,2.5,0;3.125,2.5,0;3.75,2.5,0;4.375,2.5,0;5.,2.5,0;5.625,2.5,0;6.25,2.5,0;6.875,2.5,0;7.5,2.5,0;8.125,2.5,0;8.75,2.5,0;9.375,2.5,0;10.,2.5,0;0.,3.75,0;0.625,3.75,0;1.25,3.75,0;1.875,3.75,0;2.5,3.75,0;3.125,3.75,0;3.75,3.75,0;4.375,3.75,0;5.,3.75,0;5.625,3.75,0;6.25,3.75,0;6.875,3.75,0;7.5,3.75,0;8.125,3.75,0;8.75,3.75,0;9.375,3.75,0;10.,3.75,0;0.,5.,0;0.625,5.,0;1.25,5.,0;1.875,5.,0;2.5,5.,0;3.125,5.,0;3.75,5.,0;4.375,5.,0;5.,5.,0;5.625,5.,0;6.25,5.,0;6.875,5.,0;7.5,5.,0;8.125,5.,0;8.75,5.,0;9.375,5.,0;10.,5.,0;0.,6.25,0;0.625,6.25,0;1.25,6.25,0;1.875,6.25,0;2.5,6.25,0;3.125,6.25,0;3.75,6.25,0;4.375,6.25,0;5.,6.25,0;5.625,6.25,0;6.25,6.25,0;6.875,6.25,0;7.5,6.25,0;8.125,6.25,0;8.75,6.25,0;9.375,6.25,0;10.,6.25,0;0.,7.5,0;0.625,7.5,0;1.25,7.5,0;1.875,7.5,0;2.5,7.5,0;3.125,7.5,0;3.75,7.5,0;4.375,7.5,0;5.,7.5,0;5.625,7.5,0;6.25,7.5,0;6.875,7.5,0;7.5,7.5,0;8.125,7.5,0;8.75,7.5,0;9.375,7.5,0;10.,7.5,0;0.,8.75,0;0.625,8.75,0;1.25,8.75,0;1.875,8.75,0;2.5,8.75,0;3.125,8.75,0;3.75,8.75,0;4.375,8.75,0;5.,8.75,0;5.625,8.75,0;6.25,8.75,0;6.875,8.75,0;7.5,8.75,0;8.125,8.75,0;8.75,8.75,0;9.375,8.75,0;10.,8.75,0;0.,10.,0;0.625,10.,0;1.25,10.,0;1.875,10.,0;2.5,10.,0;3.125,10.,0;3.75,10.,0;4.375,10.,0;5.,10.,0;5.625,10.,0;6.25,10.,0;6.875,10.,0;7.5,10.,0;8.125,10.,0;8.75,10.,0;9.375,10.,0;10.,10.,0;0.,0.625,0;1.25,0.625,0;2.5,0.625,0;3.75,0.625,0;5.,0.625,0;6.25,0.625,0;7.5,0.625,0;8.75,0.625,0;10.,0.625,0;0.,1.875,0;1.25,1.875,0;2.5,1.875,0;3.75,1.875,0;5.,1.875,0;6.25,1.875,0;7.5,1.875,0;8.75,1.875,0;10.,1.875,0;0.,3.125,0;1.25,3.125,0;2.5,3.125,0;3.75,3.125,0;5.,3.125,0;6.25,3.125,0;7.5,3.125,0;8.75,3.125,0;10.,3.125,0;0.,4.375,0;1.25,4.375,0;2.5,4.375,0;3.75,4.375,0;5.,4.375,0;6.25,4.375,0;7.5,4.375,0;8.75,4.375,0;10.,4.375,0;0.,5.625,0;1.25,5.625,0;2.5,5.625,0;3.75,5.625,0;5.,5.625,0;6.25,5.625,0;7.5,5.625,0;8.75,5.625,0;10.,5.625,0;0.,6.875,0;1.25,6.875,0;2.5,6.875,0;3.75,6.875,0;5.,6.875,0;6.25,6.875,0;7.5,6.875,0;8.75,6.875,0;10.,6.875,0;0.,8.125,0;1.25,8.125,0;2.5,8.125,0;3.75,8.125,0;5.,8.125,0;6.25,8.125,0;7.5,8.125,0;8.75,8.125,0;10.,8.125,0;0.,9.375,0;1.25,9.375,0;2.5,9.375,0;3.75,9.375,0;5.,9.375,0;6.25,9.375,0;7.5,9.375,0;8.75,9.375,0;10.,9.375,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,155,20,19,18,154;18,19,20,164,37,36,35,163;35,36,37,173,54,53,52,172;52,53,54,182,71,70,69,181;69,70,71,191,88,87,86,190;86,87,88,200,105,104,103,199;103,104,105,209,122,121,120,208;120,121,122,218,139,138,137,217;3,4,5,156,22,21,20,155;20,21,22,165,39,38,37,164;37,38,39,174,56,55,54,173;54,55,56,183,73,72,71,182;71,72,73,192,90,89,88,191;88,89,90,201,107,106,105,200;105,106,107,210,124,123,122,209;122,123,124,219,141,140,139,218;5,6,7,157,24,23,22,156;22,23,24,166,41,40,39,165;39,40,41,175,58,57,56,174;56,57,58,184,75,74,73,183;73,74,75,193,92,91,90,192;90,91,92,202,109,108,107,201;107,108,109,211,126,125,124,210;124,125,126,220,143,142,141,219;7,8,9,158,26,25,24,157;24,25,26,167,43,42,41,166;41,42,43,176,60,59,58,175;58,59,60,185,77,76,75,184;75,76,77,194,94,93,92,193;92,93,94,203,111,110,109,202;109,110,111,212,128,127,126,211;126,127,128,221,145,144,143,220;9,10,11,159,28,27,26,158;26,27,28,168,45,44,43,167;43,44,45,177,62,61,60,176;60,61,62,186,79,78,77,185;77,78,79,195,96,95,94,194;94,95,96,204,113,112,111,203;111,112,113,213,130,129,128,212;128,129,130,222,147,146,145,221;11,12,13,160,30,29,28,159;28,29,30,169,47,46,45,168;45,46,47,178,64,63,62,177;62,63,64,187,81,80,79,186;79,80,81,196,98,97,96,195;96,97,98,205,115,114,113,204;113,114,115,214,132,131,130,213;130,131,132,223,149,148,147,222;13,14,15,161,32,31,30,160;30,31,32,170,49,48,47,169;47,48,49,179,66,65,64,178;64,65,66,188,83,82,81,187;81,82,83,197,100,99,98,196;98,99,100,206,117,116,115,205;115,116,117,215,134,133,132,214;132,133,134,224,151,150,149,223;15,16,17,162,34,33,32,161;32,33,34,171,51,50,49,170;49,50,51,180,68,67,66,179;66,67,68,189,85,84,83,188;83,84,85,198,102,101,100,197;100,101,102,207,119,118,117,206;117,118,119,216,136,135,134,215;134,135,136,225,153,152,151,224];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];