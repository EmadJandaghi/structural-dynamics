% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=12;ney=12;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.416667,0.,0;0.833333,0.,0;1.25,0.,0;1.66667,0.,0;2.08333,0.,0;2.5,0.,0;2.91667,0.,0;3.33333,0.,0;3.75,0.,0;4.16667,0.,0;4.58333,0.,0;5.,0.,0;5.41667,0.,0;5.83333,0.,0;6.25,0.,0;6.66667,0.,0;7.08333,0.,0;7.5,0.,0;7.91667,0.,0;8.33333,0.,0;8.75,0.,0;9.16667,0.,0;9.58333,0.,0;10.,0.,0;0.,0.833333,0;0.416667,0.833333,0;0.833333,0.833333,0;1.25,0.833333,0;1.66667,0.833333,0;2.08333,0.833333,0;2.5,0.833333,0;2.91667,0.833333,0;3.33333,0.833333,0;3.75,0.833333,0;4.16667,0.833333,0;4.58333,0.833333,0;5.,0.833333,0;5.41667,0.833333,0;5.83333,0.833333,0;6.25,0.833333,0;6.66667,0.833333,0;7.08333,0.833333,0;7.5,0.833333,0;7.91667,0.833333,0;8.33333,0.833333,0;8.75,0.833333,0;9.16667,0.833333,0;9.58333,0.833333,0;10.,0.833333,0;0.,1.66667,0;0.416667,1.66667,0;0.833333,1.66667,0;1.25,1.66667,0;1.66667,1.66667,0;2.08333,1.66667,0;2.5,1.66667,0;2.91667,1.66667,0;3.33333,1.66667,0;3.75,1.66667,0;4.16667,1.66667,0;4.58333,1.66667,0;5.,1.66667,0;5.41667,1.66667,0;5.83333,1.66667,0;6.25,1.66667,0;6.66667,1.66667,0;7.08333,1.66667,0;7.5,1.66667,0;7.91667,1.66667,0;8.33333,1.66667,0;8.75,1.66667,0;9.16667,1.66667,0;9.58333,1.66667,0;10.,1.66667,0;0.,2.5,0;0.416667,2.5,0;0.833333,2.5,0;1.25,2.5,0;1.66667,2.5,0;2.08333,2.5,0;2.5,2.5,0;2.91667,2.5,0;3.33333,2.5,0;3.75,2.5,0;4.16667,2.5,0;4.58333,2.5,0;5.,2.5,0;5.41667,2.5,0;5.83333,2.5,0;6.25,2.5,0;6.66667,2.5,0;7.08333,2.5,0;7.5,2.5,0;7.91667,2.5,0;8.33333,2.5,0;8.75,2.5,0;9.16667,2.5,0;9.58333,2.5,0;10.,2.5,0;0.,3.33333,0;0.416667,3.33333,0;0.833333,3.33333,0;1.25,3.33333,0;1.66667,3.33333,0;2.08333,3.33333,0;2.5,3.33333,0;2.91667,3.33333,0;3.33333,3.33333,0;3.75,3.33333,0;4.16667,3.33333,0;4.58333,3.33333,0;5.,3.33333,0;5.41667,3.33333,0;5.83333,3.33333,0;6.25,3.33333,0;6.66667,3.33333,0;7.08333,3.33333,0;7.5,3.33333,0;7.91667,3.33333,0;8.33333,3.33333,0;8.75,3.33333,0;9.16667,3.33333,0;9.58333,3.33333,0;10.,3.33333,0;0.,4.16667,0;0.416667,4.16667,0;0.833333,4.16667,0;1.25,4.16667,0;1.66667,4.16667,0;2.08333,4.16667,0;2.5,4.16667,0;2.91667,4.16667,0;3.33333,4.16667,0;3.75,4.16667,0;4.16667,4.16667,0;4.58333,4.16667,0;5.,4.16667,0;5.41667,4.16667,0;5.83333,4.16667,0;6.25,4.16667,0;6.66667,4.16667,0;7.08333,4.16667,0;7.5,4.16667,0;7.91667,4.16667,0;8.33333,4.16667,0;8.75,4.16667,0;9.16667,4.16667,0;9.58333,4.16667,0;10.,4.16667,0;0.,5.,0;0.416667,5.,0;0.833333,5.,0;1.25,5.,0;1.66667,5.,0;2.08333,5.,0;2.5,5.,0;2.91667,5.,0;3.33333,5.,0;3.75,5.,0;4.16667,5.,0;4.58333,5.,0;5.,5.,0;5.41667,5.,0;5.83333,5.,0;6.25,5.,0;6.66667,5.,0;7.08333,5.,0;7.5,5.,0;7.91667,5.,0;8.33333,5.,0;8.75,5.,0;9.16667,5.,0;9.58333,5.,0;10.,5.,0;0.,5.83333,0;0.416667,5.83333,0;0.833333,5.83333,0;1.25,5.83333,0;1.66667,5.83333,0;2.08333,5.83333,0;2.5,5.83333,0;2.91667,5.83333,0;3.33333,5.83333,0;3.75,5.83333,0;4.16667,5.83333,0;4.58333,5.83333,0;5.,5.83333,0;5.41667,5.83333,0;5.83333,5.83333,0;6.25,5.83333,0;6.66667,5.83333,0;7.08333,5.83333,0;7.5,5.83333,0;7.91667,5.83333,0;8.33333,5.83333,0;8.75,5.83333,0;9.16667,5.83333,0;9.58333,5.83333,0;10.,5.83333,0;0.,6.66667,0;0.416667,6.66667,0;0.833333,6.66667,0;1.25,6.66667,0;1.66667,6.66667,0;2.08333,6.66667,0;2.5,6.66667,0;2.91667,6.66667,0;3.33333,6.66667,0;3.75,6.66667,0;4.16667,6.66667,0;4.58333,6.66667,0;5.,6.66667,0;5.41667,6.66667,0;5.83333,6.66667,0;6.25,6.66667,0;6.66667,6.66667,0;7.08333,6.66667,0;7.5,6.66667,0;7.91667,6.66667,0;8.33333,6.66667,0;8.75,6.66667,0;9.16667,6.66667,0;9.58333,6.66667,0;10.,6.66667,0;0.,7.5,0;0.416667,7.5,0;0.833333,7.5,0;1.25,7.5,0;1.66667,7.5,0;2.08333,7.5,0;2.5,7.5,0;2.91667,7.5,0;3.33333,7.5,0;3.75,7.5,0;4.16667,7.5,0;4.58333,7.5,0;5.,7.5,0;5.41667,7.5,0;5.83333,7.5,0;6.25,7.5,0;6.66667,7.5,0;7.08333,7.5,0;7.5,7.5,0;7.91667,7.5,0;8.33333,7.5,0;8.75,7.5,0;9.16667,7.5,0;9.58333,7.5,0;10.,7.5,0;0.,8.33333,0;0.416667,8.33333,0;0.833333,8.33333,0;1.25,8.33333,0;1.66667,8.33333,0;2.08333,8.33333,0;2.5,8.33333,0;2.91667,8.33333,0;3.33333,8.33333,0;3.75,8.33333,0;4.16667,8.33333,0;4.58333,8.33333,0;5.,8.33333,0;5.41667,8.33333,0;5.83333,8.33333,0;6.25,8.33333,0;6.66667,8.33333,0;7.08333,8.33333,0;7.5,8.33333,0;7.91667,8.33333,0;8.33333,8.33333,0;8.75,8.33333,0;9.16667,8.33333,0;9.58333,8.33333,0;10.,8.33333,0;0.,9.16667,0;0.416667,9.16667,0;0.833333,9.16667,0;1.25,9.16667,0;1.66667,9.16667,0;2.08333,9.16667,0;2.5,9.16667,0;2.91667,9.16667,0;3.33333,9.16667,0;3.75,9.16667,0;4.16667,9.16667,0;4.58333,9.16667,0;5.,9.16667,0;5.41667,9.16667,0;5.83333,9.16667,0;6.25,9.16667,0;6.66667,9.16667,0;7.08333,9.16667,0;7.5,9.16667,0;7.91667,9.16667,0;8.33333,9.16667,0;8.75,9.16667,0;9.16667,9.16667,0;9.58333,9.16667,0;10.,9.16667,0;0.,10.,0;0.416667,10.,0;0.833333,10.,0;1.25,10.,0;1.66667,10.,0;2.08333,10.,0;2.5,10.,0;2.91667,10.,0;3.33333,10.,0;3.75,10.,0;4.16667,10.,0;4.58333,10.,0;5.,10.,0;5.41667,10.,0;5.83333,10.,0;6.25,10.,0;6.66667,10.,0;7.08333,10.,0;7.5,10.,0;7.91667,10.,0;8.33333,10.,0;8.75,10.,0;9.16667,10.,0;9.58333,10.,0;10.,10.,0;0.,0.416667,0;0.833333,0.416667,0;1.66667,0.416667,0;2.5,0.416667,0;3.33333,0.416667,0;4.16667,0.416667,0;5.,0.416667,0;5.83333,0.416667,0;6.66667,0.416667,0;7.5,0.416667,0;8.33333,0.416667,0;9.16667,0.416667,0;10.,0.416667,0;0.,1.25,0;0.833333,1.25,0;1.66667,1.25,0;2.5,1.25,0;3.33333,1.25,0;4.16667,1.25,0;5.,1.25,0;5.83333,1.25,0;6.66667,1.25,0;7.5,1.25,0;8.33333,1.25,0;9.16667,1.25,0;10.,1.25,0;0.,2.08333,0;0.833333,2.08333,0;1.66667,2.08333,0;2.5,2.08333,0;3.33333,2.08333,0;4.16667,2.08333,0;5.,2.08333,0;5.83333,2.08333,0;6.66667,2.08333,0;7.5,2.08333,0;8.33333,2.08333,0;9.16667,2.08333,0;10.,2.08333,0;0.,2.91667,0;0.833333,2.91667,0;1.66667,2.91667,0;2.5,2.91667,0;3.33333,2.91667,0;4.16667,2.91667,0;5.,2.91667,0;5.83333,2.91667,0;6.66667,2.91667,0;7.5,2.91667,0;8.33333,2.91667,0;9.16667,2.91667,0;10.,2.91667,0;0.,3.75,0;0.833333,3.75,0;1.66667,3.75,0;2.5,3.75,0;3.33333,3.75,0;4.16667,3.75,0;5.,3.75,0;5.83333,3.75,0;6.66667,3.75,0;7.5,3.75,0;8.33333,3.75,0;9.16667,3.75,0;10.,3.75,0;0.,4.58333,0;0.833333,4.58333,0;1.66667,4.58333,0;2.5,4.58333,0;3.33333,4.58333,0;4.16667,4.58333,0;5.,4.58333,0;5.83333,4.58333,0;6.66667,4.58333,0;7.5,4.58333,0;8.33333,4.58333,0;9.16667,4.58333,0;10.,4.58333,0;0.,5.41667,0;0.833333,5.41667,0;1.66667,5.41667,0;2.5,5.41667,0;3.33333,5.41667,0;4.16667,5.41667,0;5.,5.41667,0;5.83333,5.41667,0;6.66667,5.41667,0;7.5,5.41667,0;8.33333,5.41667,0;9.16667,5.41667,0;10.,5.41667,0;0.,6.25,0;0.833333,6.25,0;1.66667,6.25,0;2.5,6.25,0;3.33333,6.25,0;4.16667,6.25,0;5.,6.25,0;5.83333,6.25,0;6.66667,6.25,0;7.5,6.25,0;8.33333,6.25,0;9.16667,6.25,0;10.,6.25,0;0.,7.08333,0;0.833333,7.08333,0;1.66667,7.08333,0;2.5,7.08333,0;3.33333,7.08333,0;4.16667,7.08333,0;5.,7.08333,0;5.83333,7.08333,0;6.66667,7.08333,0;7.5,7.08333,0;8.33333,7.08333,0;9.16667,7.08333,0;10.,7.08333,0;0.,7.91667,0;0.833333,7.91667,0;1.66667,7.91667,0;2.5,7.91667,0;3.33333,7.91667,0;4.16667,7.91667,0;5.,7.91667,0;5.83333,7.91667,0;6.66667,7.91667,0;7.5,7.91667,0;8.33333,7.91667,0;9.16667,7.91667,0;10.,7.91667,0;0.,8.75,0;0.833333,8.75,0;1.66667,8.75,0;2.5,8.75,0;3.33333,8.75,0;4.16667,8.75,0;5.,8.75,0;5.83333,8.75,0;6.66667,8.75,0;7.5,8.75,0;8.33333,8.75,0;9.16667,8.75,0;10.,8.75,0;0.,9.58333,0;0.833333,9.58333,0;1.66667,9.58333,0;2.5,9.58333,0;3.33333,9.58333,0;4.16667,9.58333,0;5.,9.58333,0;5.83333,9.58333,0;6.66667,9.58333,0;7.5,9.58333,0;8.33333,9.58333,0;9.16667,9.58333,0;10.,9.58333,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,327,28,27,26,326;26,27,28,340,53,52,51,339;51,52,53,353,78,77,76,352;76,77,78,366,103,102,101,365;101,102,103,379,128,127,126,378;126,127,128,392,153,152,151,391;151,152,153,405,178,177,176,404;176,177,178,418,203,202,201,417;201,202,203,431,228,227,226,430;226,227,228,444,253,252,251,443;251,252,253,457,278,277,276,456;276,277,278,470,303,302,301,469;3,4,5,328,30,29,28,327;28,29,30,341,55,54,53,340;53,54,55,354,80,79,78,353;78,79,80,367,105,104,103,366;103,104,105,380,130,129,128,379;128,129,130,393,155,154,153,392;153,154,155,406,180,179,178,405;178,179,180,419,205,204,203,418;203,204,205,432,230,229,228,431;228,229,230,445,255,254,253,444;253,254,255,458,280,279,278,457;278,279,280,471,305,304,303,470;5,6,7,329,32,31,30,328;30,31,32,342,57,56,55,341;55,56,57,355,82,81,80,354;80,81,82,368,107,106,105,367;105,106,107,381,132,131,130,380;130,131,132,394,157,156,155,393;155,156,157,407,182,181,180,406;180,181,182,420,207,206,205,419;205,206,207,433,232,231,230,432;230,231,232,446,257,256,255,445;255,256,257,459,282,281,280,458;280,281,282,472,307,306,305,471;7,8,9,330,34,33,32,329;32,33,34,343,59,58,57,342;57,58,59,356,84,83,82,355;82,83,84,369,109,108,107,368;107,108,109,382,134,133,132,381;132,133,134,395,159,158,157,394;157,158,159,408,184,183,182,407;182,183,184,421,209,208,207,420;207,208,209,434,234,233,232,433;232,233,234,447,259,258,257,446;257,258,259,460,284,283,282,459;282,283,284,473,309,308,307,472;9,10,11,331,36,35,34,330;34,35,36,344,61,60,59,343;59,60,61,357,86,85,84,356;84,85,86,370,111,110,109,369;109,110,111,383,136,135,134,382;134,135,136,396,161,160,159,395;159,160,161,409,186,185,184,408;184,185,186,422,211,210,209,421;209,210,211,435,236,235,234,434;234,235,236,448,261,260,259,447;259,260,261,461,286,285,284,460;284,285,286,474,311,310,309,473;11,12,13,332,38,37,36,331;36,37,38,345,63,62,61,344;61,62,63,358,88,87,86,357;86,87,88,371,113,112,111,370;111,112,113,384,138,137,136,383;136,137,138,397,163,162,161,396;161,162,163,410,188,187,186,409;186,187,188,423,213,212,211,422;211,212,213,436,238,237,236,435;236,237,238,449,263,262,261,448;261,262,263,462,288,287,286,461;286,287,288,475,313,312,311,474;13,14,15,333,40,39,38,332;38,39,40,346,65,64,63,345;63,64,65,359,90,89,88,358;88,89,90,372,115,114,113,371;113,114,115,385,140,139,138,384;138,139,140,398,165,164,163,397;163,164,165,411,190,189,188,410;188,189,190,424,215,214,213,423;213,214,215,437,240,239,238,436;238,239,240,450,265,264,263,449;263,264,265,463,290,289,288,462;288,289,290,476,315,314,313,475;15,16,17,334,42,41,40,333;40,41,42,347,67,66,65,346;65,66,67,360,92,91,90,359;90,91,92,373,117,116,115,372;115,116,117,386,142,141,140,385;140,141,142,399,167,166,165,398;165,166,167,412,192,191,190,411;190,191,192,425,217,216,215,424;215,216,217,438,242,241,240,437;240,241,242,451,267,266,265,450;265,266,267,464,292,291,290,463;290,291,292,477,317,316,315,476;17,18,19,335,44,43,42,334;42,43,44,348,69,68,67,347;67,68,69,361,94,93,92,360;92,93,94,374,119,118,117,373;117,118,119,387,144,143,142,386;142,143,144,400,169,168,167,399;167,168,169,413,194,193,192,412;192,193,194,426,219,218,217,425;217,218,219,439,244,243,242,438;242,243,244,452,269,268,267,451;267,268,269,465,294,293,292,464;292,293,294,478,319,318,317,477;19,20,21,336,46,45,44,335;44,45,46,349,71,70,69,348;69,70,71,362,96,95,94,361;94,95,96,375,121,120,119,374;119,120,121,388,146,145,144,387;144,145,146,401,171,170,169,400;169,170,171,414,196,195,194,413;194,195,196,427,221,220,219,426;219,220,221,440,246,245,244,439;244,245,246,453,271,270,269,452;269,270,271,466,296,295,294,465;294,295,296,479,321,320,319,478;21,22,23,337,48,47,46,336;46,47,48,350,73,72,71,349;71,72,73,363,98,97,96,362;96,97,98,376,123,122,121,375;121,122,123,389,148,147,146,388;146,147,148,402,173,172,171,401;171,172,173,415,198,197,196,414;196,197,198,428,223,222,221,427;221,222,223,441,248,247,246,440;246,247,248,454,273,272,271,453;271,272,273,467,298,297,296,466;296,297,298,480,323,322,321,479;23,24,25,338,50,49,48,337;48,49,50,351,75,74,73,350;73,74,75,364,100,99,98,363;98,99,100,377,125,124,123,376;123,124,125,390,150,149,148,389;148,149,150,403,175,174,173,402;173,174,175,416,200,199,198,415;198,199,200,429,225,224,223,428;223,224,225,442,250,249,248,441;248,249,250,455,275,274,273,454;273,274,275,468,300,299,298,467;298,299,300,481,325,324,323,480];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];