% calling this function will load problem geometry into the main program
% refCoords : Problem Node Coordinates in reference Configuration
% E : Young's Modulus
% nn : number of nodes
% nDOFs : total number of degrees of freedom
% elConn : element ID connectivity matrix
% DOFConn : element DOF connectivity matrix
% fixedNodes : essential node numbers
% fixedDOFs : fixed degrees of freedoms
% activeDOFs : active degrees of freedoms
% nADOFs : number of active degrees of freedoms
% L0List : Initial length of elements
% nel : Number Of Elements
% s0List : initial stress in members
nex=10;ney=10;
Lx=10; Ly=10;
Nx=0;   Ny=0;   Nxy=0;
refCoords=[0.,0.,0;0.5,0.,0;1.,0.,0;1.5,0.,0;2.,0.,0;2.5,0.,0;3.,0.,0;3.5,0.,0;4.,0.,0;4.5,0.,0;5.,0.,0;5.5,0.,0;6.,0.,0;6.5,0.,0;7.,0.,0;7.5,0.,0;8.,0.,0;8.5,0.,0;9.,0.,0;9.5,0.,0;10.,0.,0;0.,1.,0;0.5,1.,0;1.,1.,0;1.5,1.,0;2.,1.,0;2.5,1.,0;3.,1.,0;3.5,1.,0;4.,1.,0;4.5,1.,0;5.,1.,0;5.5,1.,0;6.,1.,0;6.5,1.,0;7.,1.,0;7.5,1.,0;8.,1.,0;8.5,1.,0;9.,1.,0;9.5,1.,0;10.,1.,0;0.,2.,0;0.5,2.,0;1.,2.,0;1.5,2.,0;2.,2.,0;2.5,2.,0;3.,2.,0;3.5,2.,0;4.,2.,0;4.5,2.,0;5.,2.,0;5.5,2.,0;6.,2.,0;6.5,2.,0;7.,2.,0;7.5,2.,0;8.,2.,0;8.5,2.,0;9.,2.,0;9.5,2.,0;10.,2.,0;0.,3.,0;0.5,3.,0;1.,3.,0;1.5,3.,0;2.,3.,0;2.5,3.,0;3.,3.,0;3.5,3.,0;4.,3.,0;4.5,3.,0;5.,3.,0;5.5,3.,0;6.,3.,0;6.5,3.,0;7.,3.,0;7.5,3.,0;8.,3.,0;8.5,3.,0;9.,3.,0;9.5,3.,0;10.,3.,0;0.,4.,0;0.5,4.,0;1.,4.,0;1.5,4.,0;2.,4.,0;2.5,4.,0;3.,4.,0;3.5,4.,0;4.,4.,0;4.5,4.,0;5.,4.,0;5.5,4.,0;6.,4.,0;6.5,4.,0;7.,4.,0;7.5,4.,0;8.,4.,0;8.5,4.,0;9.,4.,0;9.5,4.,0;10.,4.,0;0.,5.,0;0.5,5.,0;1.,5.,0;1.5,5.,0;2.,5.,0;2.5,5.,0;3.,5.,0;3.5,5.,0;4.,5.,0;4.5,5.,0;5.,5.,0;5.5,5.,0;6.,5.,0;6.5,5.,0;7.,5.,0;7.5,5.,0;8.,5.,0;8.5,5.,0;9.,5.,0;9.5,5.,0;10.,5.,0;0.,6.,0;0.5,6.,0;1.,6.,0;1.5,6.,0;2.,6.,0;2.5,6.,0;3.,6.,0;3.5,6.,0;4.,6.,0;4.5,6.,0;5.,6.,0;5.5,6.,0;6.,6.,0;6.5,6.,0;7.,6.,0;7.5,6.,0;8.,6.,0;8.5,6.,0;9.,6.,0;9.5,6.,0;10.,6.,0;0.,7.,0;0.5,7.,0;1.,7.,0;1.5,7.,0;2.,7.,0;2.5,7.,0;3.,7.,0;3.5,7.,0;4.,7.,0;4.5,7.,0;5.,7.,0;5.5,7.,0;6.,7.,0;6.5,7.,0;7.,7.,0;7.5,7.,0;8.,7.,0;8.5,7.,0;9.,7.,0;9.5,7.,0;10.,7.,0;0.,8.,0;0.5,8.,0;1.,8.,0;1.5,8.,0;2.,8.,0;2.5,8.,0;3.,8.,0;3.5,8.,0;4.,8.,0;4.5,8.,0;5.,8.,0;5.5,8.,0;6.,8.,0;6.5,8.,0;7.,8.,0;7.5,8.,0;8.,8.,0;8.5,8.,0;9.,8.,0;9.5,8.,0;10.,8.,0;0.,9.,0;0.5,9.,0;1.,9.,0;1.5,9.,0;2.,9.,0;2.5,9.,0;3.,9.,0;3.5,9.,0;4.,9.,0;4.5,9.,0;5.,9.,0;5.5,9.,0;6.,9.,0;6.5,9.,0;7.,9.,0;7.5,9.,0;8.,9.,0;8.5,9.,0;9.,9.,0;9.5,9.,0;10.,9.,0;0.,10.,0;0.5,10.,0;1.,10.,0;1.5,10.,0;2.,10.,0;2.5,10.,0;3.,10.,0;3.5,10.,0;4.,10.,0;4.5,10.,0;5.,10.,0;5.5,10.,0;6.,10.,0;6.5,10.,0;7.,10.,0;7.5,10.,0;8.,10.,0;8.5,10.,0;9.,10.,0;9.5,10.,0;10.,10.,0;0.,0.5,0;1.,0.5,0;2.,0.5,0;3.,0.5,0;4.,0.5,0;5.,0.5,0;6.,0.5,0;7.,0.5,0;8.,0.5,0;9.,0.5,0;10.,0.5,0;0.,1.5,0;1.,1.5,0;2.,1.5,0;3.,1.5,0;4.,1.5,0;5.,1.5,0;6.,1.5,0;7.,1.5,0;8.,1.5,0;9.,1.5,0;10.,1.5,0;0.,2.5,0;1.,2.5,0;2.,2.5,0;3.,2.5,0;4.,2.5,0;5.,2.5,0;6.,2.5,0;7.,2.5,0;8.,2.5,0;9.,2.5,0;10.,2.5,0;0.,3.5,0;1.,3.5,0;2.,3.5,0;3.,3.5,0;4.,3.5,0;5.,3.5,0;6.,3.5,0;7.,3.5,0;8.,3.5,0;9.,3.5,0;10.,3.5,0;0.,4.5,0;1.,4.5,0;2.,4.5,0;3.,4.5,0;4.,4.5,0;5.,4.5,0;6.,4.5,0;7.,4.5,0;8.,4.5,0;9.,4.5,0;10.,4.5,0;0.,5.5,0;1.,5.5,0;2.,5.5,0;3.,5.5,0;4.,5.5,0;5.,5.5,0;6.,5.5,0;7.,5.5,0;8.,5.5,0;9.,5.5,0;10.,5.5,0;0.,6.5,0;1.,6.5,0;2.,6.5,0;3.,6.5,0;4.,6.5,0;5.,6.5,0;6.,6.5,0;7.,6.5,0;8.,6.5,0;9.,6.5,0;10.,6.5,0;0.,7.5,0;1.,7.5,0;2.,7.5,0;3.,7.5,0;4.,7.5,0;5.,7.5,0;6.,7.5,0;7.,7.5,0;8.,7.5,0;9.,7.5,0;10.,7.5,0;0.,8.5,0;1.,8.5,0;2.,8.5,0;3.,8.5,0;4.,8.5,0;5.,8.5,0;6.,8.5,0;7.,8.5,0;8.,8.5,0;9.,8.5,0;10.,8.5,0;0.,9.5,0;1.,9.5,0;2.,9.5,0;3.,9.5,0;4.,9.5,0;5.,9.5,0;6.,9.5,0;7.,9.5,0;8.,9.5,0;9.,9.5,0;10.,9.5,0];
E=1e7;   % lb/in2
nn=length(refCoords);
nDOFs=5*nn;
elConn=[1,2,3,233,24,23,22,232;22,23,24,244,45,44,43,243;43,44,45,255,66,65,64,254;64,65,66,266,87,86,85,265;85,86,87,277,108,107,106,276;106,107,108,288,129,128,127,287;127,128,129,299,150,149,148,298;148,149,150,310,171,170,169,309;169,170,171,321,192,191,190,320;190,191,192,332,213,212,211,331;3,4,5,234,26,25,24,233;24,25,26,245,47,46,45,244;45,46,47,256,68,67,66,255;66,67,68,267,89,88,87,266;87,88,89,278,110,109,108,277;108,109,110,289,131,130,129,288;129,130,131,300,152,151,150,299;150,151,152,311,173,172,171,310;171,172,173,322,194,193,192,321;192,193,194,333,215,214,213,332;5,6,7,235,28,27,26,234;26,27,28,246,49,48,47,245;47,48,49,257,70,69,68,256;68,69,70,268,91,90,89,267;89,90,91,279,112,111,110,278;110,111,112,290,133,132,131,289;131,132,133,301,154,153,152,300;152,153,154,312,175,174,173,311;173,174,175,323,196,195,194,322;194,195,196,334,217,216,215,333;7,8,9,236,30,29,28,235;28,29,30,247,51,50,49,246;49,50,51,258,72,71,70,257;70,71,72,269,93,92,91,268;91,92,93,280,114,113,112,279;112,113,114,291,135,134,133,290;133,134,135,302,156,155,154,301;154,155,156,313,177,176,175,312;175,176,177,324,198,197,196,323;196,197,198,335,219,218,217,334;9,10,11,237,32,31,30,236;30,31,32,248,53,52,51,247;51,52,53,259,74,73,72,258;72,73,74,270,95,94,93,269;93,94,95,281,116,115,114,280;114,115,116,292,137,136,135,291;135,136,137,303,158,157,156,302;156,157,158,314,179,178,177,313;177,178,179,325,200,199,198,324;198,199,200,336,221,220,219,335;11,12,13,238,34,33,32,237;32,33,34,249,55,54,53,248;53,54,55,260,76,75,74,259;74,75,76,271,97,96,95,270;95,96,97,282,118,117,116,281;116,117,118,293,139,138,137,292;137,138,139,304,160,159,158,303;158,159,160,315,181,180,179,314;179,180,181,326,202,201,200,325;200,201,202,337,223,222,221,336;13,14,15,239,36,35,34,238;34,35,36,250,57,56,55,249;55,56,57,261,78,77,76,260;76,77,78,272,99,98,97,271;97,98,99,283,120,119,118,282;118,119,120,294,141,140,139,293;139,140,141,305,162,161,160,304;160,161,162,316,183,182,181,315;181,182,183,327,204,203,202,326;202,203,204,338,225,224,223,337;15,16,17,240,38,37,36,239;36,37,38,251,59,58,57,250;57,58,59,262,80,79,78,261;78,79,80,273,101,100,99,272;99,100,101,284,122,121,120,283;120,121,122,295,143,142,141,294;141,142,143,306,164,163,162,305;162,163,164,317,185,184,183,316;183,184,185,328,206,205,204,327;204,205,206,339,227,226,225,338;17,18,19,241,40,39,38,240;38,39,40,252,61,60,59,251;59,60,61,263,82,81,80,262;80,81,82,274,103,102,101,273;101,102,103,285,124,123,122,284;122,123,124,296,145,144,143,295;143,144,145,307,166,165,164,306;164,165,166,318,187,186,185,317;185,186,187,329,208,207,206,328;206,207,208,340,229,228,227,339;19,20,21,242,42,41,40,241;40,41,42,253,63,62,61,252;61,62,63,264,84,83,82,263;82,83,84,275,105,104,103,274;103,104,105,286,126,125,124,285;124,125,126,297,147,146,145,296;145,146,147,308,168,167,166,307;166,167,168,319,189,188,187,318;187,188,189,330,210,209,208,329;208,209,210,341,231,230,229,340];
th=0.5;    %(Thickness) inch
nu=0.3;   % poissons ratio
alfa=(6/5);   % Intentionally 'alfa', not alpha (shear factor)
nel=length(elConn);

[fixedDOFs,activeDOFs]=MindlinPlateBC(nex,ney);


% Automated procedure:
DOFConn=[5*elConn(:,1)-4,5*elConn(:,1)-3,5*elConn(:,1)-2,5*elConn(:,1)-1,5*elConn(:,1),...
         5*elConn(:,2)-4,5*elConn(:,2)-3,5*elConn(:,2)-2,5*elConn(:,2)-1,5*elConn(:,2),...
         5*elConn(:,3)-4,5*elConn(:,3)-3,5*elConn(:,3)-2,5*elConn(:,3)-1,5*elConn(:,3),...
         5*elConn(:,4)-4,5*elConn(:,4)-3,5*elConn(:,4)-2,5*elConn(:,4)-1,5*elConn(:,4),...
         5*elConn(:,5)-4,5*elConn(:,5)-3,5*elConn(:,5)-2,5*elConn(:,5)-1,5*elConn(:,5),...
         5*elConn(:,6)-4,5*elConn(:,6)-3,5*elConn(:,6)-2,5*elConn(:,6)-1,5*elConn(:,6),...
         5*elConn(:,7)-4,5*elConn(:,7)-3,5*elConn(:,7)-2,5*elConn(:,7)-1,5*elConn(:,7),...
         5*elConn(:,8)-4,5*elConn(:,8)-3,5*elConn(:,8)-2,5*elConn(:,8)-1,5*elConn(:,8)];

nADOfs=length(activeDOFs);
nn=length(refCoords);

Dbar=[1,nu,0;nu,1,0;0,0,0.5*(1-nu)];
G=0.5*(E/(1+nu));
Dhp=(E*th/(1-nu^2))*Dbar;
Dhb=(E*(th^3))/(12*(1-nu^2))*Dbar;
Dhs=(G*th/alfa)*eye(2);
Dh=[Dhp,zeros(3),zeros(3,2);zeros(3),Dhb,zeros(3,2);zeros(2,6),Dhs];